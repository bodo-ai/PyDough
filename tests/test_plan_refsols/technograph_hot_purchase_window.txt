ROOT(columns=[('start_of_period', ca_dt), ('n_purchases', n_purchases)], orderings=[(n_purchases):desc_last, (ca_dt):asc_first], limit=1:numeric)
 AGGREGATE(keys={'ca_dt': ca_dt}, aggregations={'n_purchases': COUNT()})
  JOIN(condition=t0.calendar_day_1 == DATETIME(t1.de_purchase_ts, 'start of day':string), type=INNER, cardinality=PLURAL_FILTER, columns={'ca_dt': t0.ca_dt})
   JOIN(condition=t1.ca_dt < DATETIME(t0.ca_dt, '+5 days':string) & t1.ca_dt >= t0.ca_dt, type=INNER, cardinality=PLURAL_ACCESS, columns={'ca_dt': t0.ca_dt, 'calendar_day_1': t1.ca_dt})
    FILTER(condition=YEAR(ca_dt) == 2024:numeric, columns={'ca_dt': ca_dt})
     SCAN(table=main.CALENDAR, columns={'ca_dt': ca_dt})
    SCAN(table=main.CALENDAR, columns={'ca_dt': ca_dt})
   SCAN(table=main.DEVICES, columns={'de_purchase_ts': de_purchase_ts})
