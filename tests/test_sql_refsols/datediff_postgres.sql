SELECT
  sbtxdatetime AS x,
  CAST('2025-05-02 11:00:00' AS TIMESTAMP) AS y1,
  CAST('2023-04-03 13:16:30' AS TIMESTAMP) AS y,
  EXTRACT(YEAR FROM CAST('2025-05-02 11:00:00' AS TIMESTAMP)) - EXTRACT(YEAR FROM CAST(sbtxdatetime AS TIMESTAMP)) AS years_diff,
  (
    EXTRACT(YEAR FROM CAST('2025-05-02 11:00:00' AS TIMESTAMP)) - EXTRACT(YEAR FROM CAST(sbtxdatetime AS TIMESTAMP))
  ) * 12 + (
    EXTRACT(MONTH FROM CAST('2025-05-02 11:00:00' AS TIMESTAMP)) - EXTRACT(MONTH FROM CAST(sbtxdatetime AS TIMESTAMP))
  ) AS months_diff,
  CAST(CAST('2025-05-02 11:00:00' AS TIMESTAMP) AS DATE) - CAST(sbtxdatetime AS DATE) AS days_diff,
  CAST(CAST(EXTRACT(EPOCH FROM (
    DATE_TRUNC('HOUR', CAST('2025-05-02 11:00:00' AS TIMESTAMP)) - DATE_TRUNC('HOUR', sbtxdatetime)
  )) AS DOUBLE PRECISION) / 3600 AS BIGINT) AS hours_diff,
  CAST(CAST(EXTRACT(EPOCH FROM (
    DATE_TRUNC('MINUTE', CAST('2023-04-03 13:16:30' AS TIMESTAMP)) - DATE_TRUNC('MINUTE', sbtxdatetime)
  )) AS DOUBLE PRECISION) / 60 AS BIGINT) AS minutes_diff,
  EXTRACT(EPOCH FROM (
    CAST('2023-04-03 13:16:30' AS TIMESTAMP) - CAST(sbtxdatetime AS TIMESTAMP)
  )) AS seconds_diff
FROM main.sbtransaction
WHERE
  EXTRACT(YEAR FROM CAST(sbtxdatetime AS TIMESTAMP)) < 2025
ORDER BY
  4 NULLS FIRST
LIMIT 30
