ROOT(columns=[('era_name', era_name), ('avg_event_gap', avg_event_gap)], orderings=[(start_year):asc_first])
 JOIN(conditions=[t0.name == t1.name], types=['inner'], columns={'avg_event_gap': t1.avg_event_gap, 'era_name': t0.era_name, 'start_year': t0.start_year})
  JOIN(conditions=[t0.start_year <= YEAR(t1.date_time) & YEAR(t1.date_time) < t0.end_year], types=['semi'], columns={'era_name': t0.era_name, 'name': t0.name, 'start_year': t0.start_year}, correl_name='corr1')
   SCAN(table=ERAS, columns={'end_year': er_end_year, 'era_name': er_name, 'name': er_name, 'start_year': er_start_year})
   SCAN(table=EVENTS, columns={'date_time': ev_dt})
  AGGREGATE(keys={'name': name}, aggregations={'avg_event_gap': AVG(day_gap)})
   PROJECT(columns={'day_gap': DATEDIFF('days':string, PREV(args=[date_time], partition=[name], order=[(date_time):asc_last]), date_time), 'name': name})
    JOIN(conditions=[t0.start_year <= YEAR(t1.date_time) & YEAR(t1.date_time) < t0.end_year], types=['inner'], columns={'date_time': t1.date_time, 'name': t0.name})
     JOIN(conditions=[t0.start_year <= YEAR(t1.date_time) & YEAR(t1.date_time) < t0.end_year], types=['semi'], columns={'end_year': t0.end_year, 'name': t0.name, 'start_year': t0.start_year}, correl_name='corr2')
      SCAN(table=ERAS, columns={'end_year': er_end_year, 'name': er_name, 'start_year': er_start_year})
      SCAN(table=EVENTS, columns={'date_time': ev_dt})
     SCAN(table=EVENTS, columns={'date_time': ev_dt})
