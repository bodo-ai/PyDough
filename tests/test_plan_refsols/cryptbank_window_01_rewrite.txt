ROOT(columns=[('account_type', UNMASK::(SUBSTRING([a_type], -1) || SUBSTRING([a_type], 1, LENGTH([a_type]) - 1))), ('key', UNMASK::(CASE WHEN [a_key] = 0 THEN 0 ELSE (CASE WHEN [a_key] > 0 THEN 1 ELSE -1 END) * CAST(SUBSTRING([a_key], 1 + INSTR([a_key], '-'), LENGTH([a_key]) / 2) AS INTEGER) END)), ('balance', UNMASK::(SQRT([a_balance])))], orderings=[(UNMASK::(SUBSTRING([a_type], -1) || SUBSTRING([a_type], 1, LENGTH([a_type]) - 1))):asc_first])
 FILTER(condition=RANKING(args=[], partition=[ISIN(a_type, ['avingss', 'etirementr']:array[unknown])], order=[(UNMASK::(SQRT([a_balance]))):desc_first], allow_ties=False) == 1:numeric, columns={'a_balance': a_balance, 'a_key': a_key, 'a_type': a_type})
  SCAN(table=CRBNK.ACCOUNTS, columns={'a_balance': a_balance, 'a_key': a_key, 'a_type': a_type})
