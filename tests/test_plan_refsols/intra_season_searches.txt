ROOT(columns=[('season_name', season_name), ('pct_season_searches', pct_season_searches), ('pct_event_searches', pct_event_searches)], orderings=[(season_name):asc_first])
 PROJECT(columns={'pct_event_searches': ROUND(100.0:numeric * DEFAULT_TO(agg_0_15, 0:numeric) / DEFAULT_TO(agg_1_15, 0:numeric), 2:numeric), 'pct_season_searches': ROUND(100.0:numeric * DEFAULT_TO(agg_2, 0:numeric) / agg_3, 2:numeric), 'season_name': agg_1})
  JOIN(conditions=[t0.agg_1 == t1.agg_1], types=['left'], columns={'agg_0_15': t1.agg_0, 'agg_1': t0.agg_1, 'agg_1_15': t1.agg_1_15, 'agg_2': t0.agg_2, 'agg_3': t0.agg_3})
   AGGREGATE(keys={'name': name}, aggregations={'agg_1': ANYTHING(name), 'agg_2': SUM(is_intra_season), 'agg_3': COUNT()})
    PROJECT(columns={'is_intra_season': DEFAULT_TO(agg_0, 0:numeric) > 0:numeric, 'name': name})
     JOIN(conditions=[t0.search_id == t1.search_id & t0.name == t1.name], types=['left'], columns={'agg_0': t1.agg_0, 'name': t0.name})
      JOIN(conditions=[MONTH(t1.ts) == t0.first_month | MONTH(t1.ts) == t0.second_month | MONTH(t1.ts) == t0.third_month], types=['inner'], columns={'name': t0.name, 'search_id': t1.search_id})
       SCAN(table=SEASONS, columns={'first_month': s_month1, 'name': s_name, 'second_month': s_month2, 'third_month': s_month3})
       SCAN(table=SEARCHES, columns={'search_id': search_id, 'ts': search_ts})
      AGGREGATE(keys={'name': name, 'search_id': search_id}, aggregations={'agg_0': COUNT()})
       FILTER(condition=name_4 == season_name, columns={'name': name, 'search_id': search_id})
        JOIN(conditions=[True:bool], types=['inner'], columns={'name': t0.name, 'name_4': t1.name, 'search_id': t0.search_id, 'season_name': t0.season_name})
         JOIN(conditions=[CONTAINS(LOWER(t0.search_string), LOWER(t1.name))], types=['inner'], columns={'name': t0.name, 'search_id': t0.search_id, 'season_name': t0.season_name})
          JOIN(conditions=[MONTH(t1.ts) == t0.first_month | MONTH(t1.ts) == t0.second_month | MONTH(t1.ts) == t0.third_month], types=['inner'], columns={'name': t0.name, 'search_id': t1.search_id, 'search_string': t1.search_string, 'season_name': t0.season_name})
           SCAN(table=SEASONS, columns={'first_month': s_month1, 'name': s_name, 'season_name': s_name, 'second_month': s_month2, 'third_month': s_month3})
           SCAN(table=SEARCHES, columns={'search_id': search_id, 'search_string': search_string, 'ts': search_ts})
          SCAN(table=EVENTS, columns={'name': ev_name})
         SCAN(table=SEASONS, columns={'name': s_name})
   AGGREGATE(keys={'agg_1': agg_1}, aggregations={'agg_0': SUM(is_intra_season), 'agg_1_15': COUNT()})
    PROJECT(columns={'agg_1': agg_1, 'is_intra_season': name_13 == agg_4})
     JOIN(conditions=[True:bool], types=['inner'], columns={'agg_1': t0.agg_1, 'agg_4': t0.agg_4, 'name_13': t1.name})
      JOIN(conditions=[CONTAINS(LOWER(t1.search_string), LOWER(t0.name))], types=['inner'], columns={'agg_1': t0.agg_1, 'agg_4': t0.agg_4})
       JOIN(conditions=[MONTH(t1.date_time) == t0.agg_0 | MONTH(t1.date_time) == t0.agg_5 | MONTH(t1.date_time) == t0.agg_6], types=['inner'], columns={'agg_1': t0.agg_1, 'agg_4': t0.agg_4, 'name': t1.name})
        AGGREGATE(keys={'name': name}, aggregations={'agg_0': ANYTHING(first_month), 'agg_1': ANYTHING(name), 'agg_4': ANYTHING(season_name), 'agg_5': ANYTHING(second_month), 'agg_6': ANYTHING(third_month)})
         JOIN(conditions=[MONTH(t1.ts) == t0.first_month | MONTH(t1.ts) == t0.second_month | MONTH(t1.ts) == t0.third_month], types=['inner'], columns={'first_month': t0.first_month, 'name': t0.name, 'season_name': t0.season_name, 'second_month': t0.second_month, 'third_month': t0.third_month})
          SCAN(table=SEASONS, columns={'first_month': s_month1, 'name': s_name, 'season_name': s_name, 'second_month': s_month2, 'third_month': s_month3})
          SCAN(table=SEARCHES, columns={'search_id': search_id, 'ts': search_ts})
        SCAN(table=EVENTS, columns={'date_time': ev_dt, 'name': ev_name})
       SCAN(table=SEARCHES, columns={'search_string': search_string})
      SCAN(table=SEASONS, columns={'name': s_name})
