ROOT(columns=[('transaction_id', transaction_id)], orderings=[(ordering_1):asc_first])
 PROJECT(columns={'ordering_1': transaction_id, 'transaction_id': transaction_id})
  FILTER(condition=shares >= cust_ticker_max_shares & shares < cust_max_shares, columns={'transaction_id': transaction_id})
   JOIN(conditions=[t0.customer_id_3 == t1.customer_id & t0.ticker_id_4 == t1.ticker_id], types=['inner'], columns={'cust_max_shares': t0.cust_max_shares, 'cust_ticker_max_shares': t0.cust_ticker_max_shares, 'shares': t1.shares, 'transaction_id': t1.transaction_id})
    JOIN(conditions=[t0.customer_id == t1.customer_id], types=['inner'], columns={'cust_max_shares': t0.cust_max_shares, 'cust_ticker_max_shares': t1.cust_ticker_max_shares, 'customer_id_3': t1.customer_id, 'ticker_id_4': t1.ticker_id})
     PROJECT(columns={'cust_max_shares': agg_0, 'customer_id': customer_id})
      AGGREGATE(keys={'customer_id': customer_id}, aggregations={'agg_0': MAX(cust_ticker_max_shares)})
       PROJECT(columns={'cust_ticker_max_shares': agg_0, 'customer_id': customer_id})
        AGGREGATE(keys={'customer_id': customer_id, 'ticker_id': ticker_id}, aggregations={'agg_0': MAX(shares)})
         SCAN(table=main.sbTransaction, columns={'customer_id': sbTxCustId, 'shares': sbTxShares, 'ticker_id': sbTxTickerId})
     PROJECT(columns={'cust_ticker_max_shares': agg_0, 'customer_id': customer_id, 'ticker_id': ticker_id})
      AGGREGATE(keys={'customer_id': customer_id, 'ticker_id': ticker_id}, aggregations={'agg_0': MAX(shares)})
       SCAN(table=main.sbTransaction, columns={'customer_id': sbTxCustId, 'shares': sbTxShares, 'ticker_id': sbTxTickerId})
    SCAN(table=main.sbTransaction, columns={'customer_id': sbTxCustId, 'shares': sbTxShares, 'ticker_id': sbTxTickerId, 'transaction_id': sbTxId})
