ROOT(columns=[('n', DEFAULT_TO(agg_0, 0:numeric))], orderings=[])
 AGGREGATE(keys={}, aggregations={'agg_0': SUM(agg_0_0)})
  JOIN(conditions=[t0.customer_key == t1.customer_key & t0.order_date == t1.order_date], types=['inner'], columns={'agg_0_0': t1.agg_0_0}, correl_name='corr1')
   PROJECT(columns={'customer_key': customer_key, 'order_date': order_date, 'total_price_sum': DEFAULT_TO(agg_1, 0:numeric)})
    FILTER(condition=agg_0 > 1:numeric, columns={'agg_1': agg_1, 'customer_key': customer_key, 'order_date': order_date})
     AGGREGATE(keys={'customer_key': customer_key, 'order_date': order_date}, aggregations={'agg_0': COUNT(), 'agg_1': SUM(total_price)})
      FILTER(condition=YEAR(order_date) == 1993:numeric, columns={'customer_key': customer_key, 'order_date': order_date, 'total_price': total_price})
       SCAN(table=tpch.ORDERS, columns={'customer_key': o_custkey, 'order_date': o_orderdate, 'total_price': o_totalprice})
   AGGREGATE(keys={'customer_key': customer_key, 'order_date': order_date}, aggregations={'agg_0_0': SUM(n_above_avg)})
    AGGREGATE(keys={'customer_key': customer_key, 'customer_key_2': customer_key, 'order_date': order_date, 'order_date_3': order_date}, aggregations={'n_above_avg': COUNT()})
     FILTER(condition=YEAR(order_date) == 1993:numeric & total_price >= 0.5:numeric * corr1.total_price_sum, columns={'customer_key': customer_key, 'order_date': order_date})
      SCAN(table=tpch.ORDERS, columns={'customer_key': o_custkey, 'order_date': o_orderdate, 'total_price': o_totalprice})
