ROOT(columns=[('transaction_id', transaction_id)], orderings=[(transaction_id):asc_first])
 FILTER(condition=n_ticker_type_trans == 1:numeric | n_cust_type_trans == 1:numeric, columns={'transaction_id': transaction_id})
  JOIN(conditions=[t0.customer_id_25 == t1.customer_id & t0.transaction_type_22_26 == t1.transaction_type_37], types=['inner'], columns={'n_cust_type_trans': t0.n_cust_type_trans, 'n_ticker_type_trans': t1.n_ticker_type_trans, 'transaction_id': t1.transaction_id})
   JOIN(conditions=[t0.customer_id == t1.customer_id], types=['inner'], columns={'customer_id_25': t1.customer_id, 'n_cust_type_trans': t1.n_cust_type_trans, 'transaction_type_22_26': t1.transaction_type_22})
    FILTER(condition=n_cust_trans > 1:numeric, columns={'customer_id': customer_id})
     PROJECT(columns={'customer_id': customer_id, 'n_cust_trans': DEFAULT_TO(agg_0, 0:numeric)})
      AGGREGATE(keys={'customer_id': customer_id}, aggregations={'agg_0': SUM(n_cust_type_trans)})
       AGGREGATE(keys={'customer_id': customer_id, 'transaction_type_11': transaction_type_11}, aggregations={'n_cust_type_trans': SUM(n_cust_type_trans)})
        JOIN(conditions=[t0.ticker_id_7 == t1.ticker_id_10 & t0.transaction_type_8 == t1.transaction_type_11], types=['inner'], columns={'customer_id': t1.customer_id, 'n_cust_type_trans': t0.n_cust_type_trans, 'transaction_type_11': t1.transaction_type_11})
         AGGREGATE(keys={'ticker_id_7': ticker_id_7, 'transaction_type_8': transaction_type_8}, aggregations={'n_cust_type_trans': SUM(n_cust_type_trans)})
          JOIN(conditions=[t0.transaction_type_4 == t1.transaction_type_8], types=['inner'], columns={'n_cust_type_trans': t0.n_cust_type_trans, 'ticker_id_7': t1.ticker_id_7, 'transaction_type_8': t1.transaction_type_8})
           PROJECT(columns={'n_cust_type_trans': 1:numeric, 'transaction_type_4': transaction_type_4})
            AGGREGATE(keys={'transaction_type_4': transaction_type_4}, aggregations={})
             JOIN(conditions=[t0.ticker_id == t1.ticker_id_3], types=['inner'], columns={'transaction_type_4': t1.transaction_type_4})
              AGGREGATE(keys={'ticker_id': ticker_id}, aggregations={})
               AGGREGATE(keys={'ticker_id': ticker_id, 'transaction_type': transaction_type}, aggregations={})
                SCAN(table=main.sbTransaction, columns={'ticker_id': sbTxTickerId, 'transaction_type': sbTxType})
              AGGREGATE(keys={'ticker_id_3': ticker_id_3, 'transaction_type_4': transaction_type_4}, aggregations={})
               AGGREGATE(keys={'ticker_id': ticker_id, 'ticker_id_2': ticker_id, 'ticker_id_3': ticker_id, 'transaction_type': transaction_type, 'transaction_type_4': transaction_type}, aggregations={})
                SCAN(table=main.sbTransaction, columns={'ticker_id': sbTxTickerId, 'transaction_type': sbTxType})
           AGGREGATE(keys={'ticker_id_7': ticker_id_7, 'transaction_type_8': transaction_type_8}, aggregations={})
            JOIN(conditions=[t0.ticker_id == t1.ticker_id_7], types=['inner'], columns={'ticker_id_7': t1.ticker_id_7, 'transaction_type_8': t1.transaction_type_8})
             AGGREGATE(keys={'ticker_id': ticker_id}, aggregations={})
              AGGREGATE(keys={'ticker_id': ticker_id, 'transaction_type': transaction_type}, aggregations={})
               SCAN(table=main.sbTransaction, columns={'ticker_id': sbTxTickerId, 'transaction_type': sbTxType})
             AGGREGATE(keys={'ticker_id': ticker_id, 'ticker_id_6': ticker_id, 'ticker_id_7': ticker_id, 'transaction_type': transaction_type, 'transaction_type_8': transaction_type}, aggregations={})
              SCAN(table=main.sbTransaction, columns={'ticker_id': sbTxTickerId, 'transaction_type': sbTxType})
         AGGREGATE(keys={'customer_id': customer_id, 'ticker_id_10': ticker_id_10, 'transaction_type_11': transaction_type_11}, aggregations={})
          SCAN(table=main.sbTransaction, columns={'customer_id': sbTxCustId, 'ticker_id_10': sbTxTickerId, 'transaction_type_11': sbTxType})
    AGGREGATE(keys={'customer_id': customer_id, 'transaction_type_22': transaction_type_22}, aggregations={'n_cust_type_trans': SUM(n_cust_type_trans)})
     JOIN(conditions=[t0.ticker_id_18 == t1.ticker_id_21 & t0.transaction_type_19 == t1.transaction_type_22], types=['inner'], columns={'customer_id': t1.customer_id, 'n_cust_type_trans': t0.n_cust_type_trans, 'transaction_type_22': t1.transaction_type_22})
      AGGREGATE(keys={'ticker_id_18': ticker_id_18, 'transaction_type_19': transaction_type_19}, aggregations={'n_cust_type_trans': SUM(n_cust_type_trans)})
       JOIN(conditions=[t0.transaction_type_15 == t1.transaction_type_19], types=['inner'], columns={'n_cust_type_trans': t0.n_cust_type_trans, 'ticker_id_18': t1.ticker_id_18, 'transaction_type_19': t1.transaction_type_19})
        PROJECT(columns={'n_cust_type_trans': 1:numeric, 'transaction_type_15': transaction_type_15})
         AGGREGATE(keys={'transaction_type_15': transaction_type_15}, aggregations={})
          JOIN(conditions=[t0.ticker_id == t1.ticker_id_14], types=['inner'], columns={'transaction_type_15': t1.transaction_type_15})
           AGGREGATE(keys={'ticker_id': ticker_id}, aggregations={})
            AGGREGATE(keys={'ticker_id': ticker_id, 'transaction_type': transaction_type}, aggregations={})
             SCAN(table=main.sbTransaction, columns={'ticker_id': sbTxTickerId, 'transaction_type': sbTxType})
           AGGREGATE(keys={'ticker_id_14': ticker_id_14, 'transaction_type_15': transaction_type_15}, aggregations={})
            AGGREGATE(keys={'ticker_id': ticker_id, 'ticker_id_13': ticker_id, 'ticker_id_14': ticker_id, 'transaction_type': transaction_type, 'transaction_type_15': transaction_type}, aggregations={})
             SCAN(table=main.sbTransaction, columns={'ticker_id': sbTxTickerId, 'transaction_type': sbTxType})
        AGGREGATE(keys={'ticker_id_18': ticker_id_18, 'transaction_type_19': transaction_type_19}, aggregations={})
         JOIN(conditions=[t0.ticker_id == t1.ticker_id_18], types=['inner'], columns={'ticker_id_18': t1.ticker_id_18, 'transaction_type_19': t1.transaction_type_19})
          AGGREGATE(keys={'ticker_id': ticker_id}, aggregations={})
           AGGREGATE(keys={'ticker_id': ticker_id, 'transaction_type': transaction_type}, aggregations={})
            SCAN(table=main.sbTransaction, columns={'ticker_id': sbTxTickerId, 'transaction_type': sbTxType})
          AGGREGATE(keys={'ticker_id': ticker_id, 'ticker_id_17': ticker_id, 'ticker_id_18': ticker_id, 'transaction_type': transaction_type, 'transaction_type_19': transaction_type}, aggregations={})
           SCAN(table=main.sbTransaction, columns={'ticker_id': sbTxTickerId, 'transaction_type': sbTxType})
      AGGREGATE(keys={'customer_id': customer_id, 'ticker_id_21': ticker_id_21, 'transaction_type_22': transaction_type_22}, aggregations={})
       SCAN(table=main.sbTransaction, columns={'customer_id': sbTxCustId, 'ticker_id_21': sbTxTickerId, 'transaction_type_22': sbTxType})
   JOIN(conditions=[t0.ticker_id_33 == t1.ticker_id_36 & t0.transaction_type_34 == t1.transaction_type_37], types=['inner'], columns={'customer_id': t1.customer_id, 'n_ticker_type_trans': t0.n_ticker_type_trans, 'transaction_id': t1.transaction_id, 'transaction_type_37': t1.transaction_type_37})
    JOIN(conditions=[t0.transaction_type_30 == t1.transaction_type_34], types=['inner'], columns={'n_ticker_type_trans': t1.n_ticker_type_trans, 'ticker_id_33': t1.ticker_id_33, 'transaction_type_34': t1.transaction_type_34})
     FILTER(condition=n_type_trans > 1:numeric, columns={'transaction_type_30': transaction_type_30})
      PROJECT(columns={'n_type_trans': DEFAULT_TO(agg_0, 0:numeric), 'transaction_type_30': transaction_type_30})
       AGGREGATE(keys={'transaction_type_30': transaction_type_30}, aggregations={'agg_0': SUM(agg_0_0)})
        JOIN(conditions=[t0.ticker_id == t1.ticker_id_29], types=['inner'], columns={'agg_0_0': t1.agg_0_0, 'transaction_type_30': t1.transaction_type_30})
         AGGREGATE(keys={'ticker_id': ticker_id}, aggregations={})
          AGGREGATE(keys={'ticker_id': ticker_id, 'transaction_type': transaction_type}, aggregations={})
           SCAN(table=main.sbTransaction, columns={'ticker_id': sbTxTickerId, 'transaction_type': sbTxType})
         AGGREGATE(keys={'ticker_id_29': ticker_id_29, 'transaction_type_30': transaction_type_30}, aggregations={'agg_0_0': SUM(n_ticker_type_trans)})
          AGGREGATE(keys={'ticker_id': ticker_id, 'ticker_id_28': ticker_id, 'ticker_id_29': ticker_id, 'transaction_type': transaction_type, 'transaction_type_30': transaction_type}, aggregations={'n_ticker_type_trans': COUNT()})
           SCAN(table=main.sbTransaction, columns={'ticker_id': sbTxTickerId, 'transaction_type': sbTxType})
     JOIN(conditions=[t0.ticker_id == t1.ticker_id_33], types=['inner'], columns={'n_ticker_type_trans': t1.n_ticker_type_trans, 'ticker_id_33': t1.ticker_id_33, 'transaction_type_34': t1.transaction_type_34})
      FILTER(condition=n_ticker_trans > 1:numeric, columns={'ticker_id': ticker_id})
       PROJECT(columns={'n_ticker_trans': DEFAULT_TO(agg_0, 0:numeric), 'ticker_id': ticker_id})
        AGGREGATE(keys={'ticker_id': ticker_id}, aggregations={'agg_0': SUM(n_ticker_type_trans)})
         AGGREGATE(keys={'ticker_id': ticker_id, 'transaction_type': transaction_type}, aggregations={'n_ticker_type_trans': COUNT()})
          SCAN(table=main.sbTransaction, columns={'ticker_id': sbTxTickerId, 'transaction_type': sbTxType})
      AGGREGATE(keys={'ticker_id': ticker_id, 'ticker_id_32': ticker_id, 'ticker_id_33': ticker_id, 'transaction_type': transaction_type, 'transaction_type_34': transaction_type}, aggregations={'n_ticker_type_trans': COUNT()})
       SCAN(table=main.sbTransaction, columns={'ticker_id': sbTxTickerId, 'transaction_type': sbTxType})
    SCAN(table=main.sbTransaction, columns={'customer_id': sbTxCustId, 'ticker_id_36': sbTxTickerId, 'transaction_id': sbTxId, 'transaction_type_37': sbTxType})
