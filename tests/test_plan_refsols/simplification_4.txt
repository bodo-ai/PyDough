ROOT(columns=[('date_time', sbTxDateTime), ('s00', DATETIME(sbTxDateTime, 'start of week':string, '-8 weeks':string)), ('s01', False:bool), ('s02', ISIN(MONTH(sbTxDateTime), [1, 2, 3]:array[numeric])), ('s03', ISIN(MONTH(sbTxDateTime), [4, 5, 6]:array[numeric])), ('s04', ISIN(MONTH(sbTxDateTime), [7, 8, 9]:array[numeric])), ('s05', ISIN(MONTH(sbTxDateTime), [10, 11, 12]:array[numeric])), ('s06', False:bool), ('s07', False:bool), ('s08', MONTH(sbTxDateTime) < 4:numeric), ('s09', MONTH(sbTxDateTime) < 7:numeric), ('s10', MONTH(sbTxDateTime) < 10:numeric), ('s11', True:bool), ('s12', False:bool), ('s13', MONTH(sbTxDateTime) <= 3:numeric), ('s14', MONTH(sbTxDateTime) <= 6:numeric), ('s15', MONTH(sbTxDateTime) <= 9:numeric), ('s16', True:bool), ('s17', True:bool), ('s18', MONTH(sbTxDateTime) > 3:numeric), ('s19', MONTH(sbTxDateTime) > 6:numeric), ('s20', MONTH(sbTxDateTime) > 9:numeric), ('s21', False:bool), ('s22', True:bool), ('s23', MONTH(sbTxDateTime) >= 4:numeric), ('s24', MONTH(sbTxDateTime) >= 7:numeric), ('s25', MONTH(sbTxDateTime) >= 10:numeric), ('s26', False:bool), ('s27', True:bool), ('s28', NOT(ISIN(MONTH(sbTxDateTime), [1, 2, 3]:array[numeric]))), ('s29', NOT(ISIN(MONTH(sbTxDateTime), [4, 5, 6]:array[numeric]))), ('s30', NOT(ISIN(MONTH(sbTxDateTime), [7, 8, 9]:array[numeric]))), ('s31', NOT(ISIN(MONTH(sbTxDateTime), [10, 11, 12]:array[numeric]))), ('s32', True:bool), ('s33', 2024:numeric), ('s34', 3:numeric), ('s35', 8:numeric), ('s36', 13:numeric), ('s37', 12:numeric), ('s38', 45:numeric), ('s39', 59:numeric), ('s40', 2020:numeric), ('s41', 1:numeric), ('s42', 1:numeric), ('s43', 31:numeric), ('s44', 0:numeric), ('s45', 0:numeric), ('s46', 0:numeric), ('s47', 2023:numeric), ('s48', 3:numeric), ('s49', 7:numeric), ('s50', 4:numeric), ('s51', 6:numeric), ('s52', 55:numeric), ('s53', 0:numeric), ('s54', 1999:numeric), ('s55', 4:numeric), ('s56', 12:numeric), ('s57', 31:numeric), ('s58', 23:numeric), ('s59', 59:numeric), ('s60', 58:numeric), ('s61', False:bool), ('s62', False:bool), ('s63', False:bool), ('s64', True:bool), ('s65', True:bool), ('s66', True:bool), ('s67', False:bool), ('s68', False:bool), ('s69', False:bool), ('s70', True:bool), ('s71', True:bool), ('s72', True:bool), ('s73', False:bool), ('s74', False:bool), ('s75', True:bool), ('s76', True:bool), ('s77', False:bool), ('s78', True:bool), ('s79', False:bool), ('s80', True:bool), ('s81', True:bool), ('s82', False:bool), ('s83', True:bool), ('s84', False:bool), ('s85', False:bool), ('s86', True:bool), ('s87', False:bool), ('s88', False:bool), ('s89', True:bool), ('s90', True:bool), ('s91', False:bool), ('s92', True:bool), ('s93', False:bool), ('s94', False:bool), ('s95', True:bool), ('s96', True:bool), ('s97', datetime.date(2025, 2, 28):datetime)], orderings=[])
 FILTER(condition=RANKING(args=[], partition=[], order=[(sbTxDateTime):asc_last]) == 1:numeric | RANKING(args=[], partition=[], order=[(sbTxDateTime):desc_first]) == 1:numeric, columns={'sbTxDateTime': sbTxDateTime})
  FILTER(condition=YEAR(sbTxDateTime) == 2023:numeric, columns={'sbTxDateTime': sbTxDateTime})
   SCAN(table=main.sbTransaction, columns={'sbTxDateTime': sbTxDateTime})
