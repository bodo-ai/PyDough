SELECT
  ANY_VALUE(CARS.make) AS make,
  ANY_VALUE(CARS.model) AS model,
  ANY_VALUE(SALES.sale_price) AS sale_price
FROM MAIN.SALES AS SALES
JOIN MAIN.CARS AS CARS
  ON CARS._id = SALES.car_id
JOIN MAIN.INVENTORY_SNAPSHOTS AS INVENTORY_SNAPSHOTS
  ON CARS._id = INVENTORY_SNAPSHOTS.car_id
  AND INVENTORY_SNAPSHOTS.is_in_inventory = 0
  AND INVENTORY_SNAPSHOTS.snapshot_date = SALES.sale_date
GROUP BY
  SALES._id,
  CARS._id
ORDER BY
  SALE_PRICE DESC NULLS LAST
LIMIT 1
