SELECT
  sbtxdatetime AS x,
  CAST('2025-05-02 11:00:00' AS TIMESTAMP) AS y1,
  CAST('2023-04-03 13:16:30' AS TIMESTAMP) AS y,
  CAST(EXTRACT(YEAR FROM CAST(AGE(CAST('2025-05-02 11:00:00' AS TIMESTAMP), CAST(sbtxdatetime AS TIMESTAMP)) AS TIMESTAMP)) AS BIGINT) AS years_diff,
  CAST(EXTRACT(YEAR FROM CAST(AGE(CAST('2025-05-02 11:00:00' AS TIMESTAMP), CAST(sbtxdatetime AS TIMESTAMP)) AS TIMESTAMP)) * 12 + EXTRACT(MONTH FROM CAST(AGE(CAST('2025-05-02 11:00:00' AS TIMESTAMP), CAST(sbtxdatetime AS TIMESTAMP)) AS TIMESTAMP)) AS BIGINT) AS months_diff,
  EXTRACT(EPOCH FROM CAST('2025-05-02 11:00:00' AS TIMESTAMP) - CAST(sbtxdatetime AS TIMESTAMP)) / 86400 AS days_diff,
  EXTRACT(EPOCH FROM CAST('2025-05-02 11:00:00' AS TIMESTAMP) - CAST(sbtxdatetime AS TIMESTAMP)) / 3600 AS hours_diff,
  EXTRACT(EPOCH FROM CAST('2023-04-03 13:16:30' AS TIMESTAMP) - CAST(sbtxdatetime AS TIMESTAMP)) / 60 AS minutes_diff,
  CAST(EXTRACT(EPOCH FROM CAST('2023-04-03 13:16:30' AS TIMESTAMP) - CAST(sbtxdatetime AS TIMESTAMP)) AS BIGINT) AS seconds_diff
FROM main.sbtransaction
WHERE
  EXTRACT(YEAR FROM CAST(sbtxdatetime AS TIMESTAMP)) < 2025
ORDER BY
  CAST(EXTRACT(YEAR FROM CAST(AGE(CAST('2025-05-02 11:00:00' AS TIMESTAMP), CAST(sbtxdatetime AS TIMESTAMP)) AS TIMESTAMP)) AS BIGINT) NULLS FIRST
LIMIT 30
