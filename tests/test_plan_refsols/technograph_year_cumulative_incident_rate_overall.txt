ROOT(columns=[('yr', yr), ('cum_ir', cum_ir), ('pct_bought_change', pct_bought_change), ('pct_incident_change', pct_incident_change), ('bought', bought), ('incidents', incidents)], orderings=[(yr):asc_first])
 PROJECT(columns={'bought': n_devices, 'cum_ir': ROUND(RELSUM(args=[n_incidents], partition=[], order=[(year):asc_last], cumulative=True) / RELSUM(args=[n_devices], partition=[], order=[(year):asc_last], cumulative=True), 2:numeric), 'incidents': n_incidents, 'pct_bought_change': ROUND(100.0:numeric * n_devices - PREV(args=[n_devices], partition=[], order=[(year):asc_last]) / PREV(args=[n_devices], partition=[], order=[(year):asc_last]), 2:numeric), 'pct_incident_change': ROUND(100.0:numeric * n_incidents - PREV(args=[n_incidents], partition=[], order=[(year):asc_last]) / PREV(args=[n_incidents], partition=[], order=[(year):asc_last]), 2:numeric), 'yr': year})
  FILTER(condition=n_devices > 0:numeric, columns={'n_devices': n_devices, 'n_incidents': n_incidents, 'year': year})
   PROJECT(columns={'n_devices': DEFAULT_TO(agg_4, 0:numeric), 'n_incidents': DEFAULT_TO(agg_7, 0:numeric), 'year': year})
    AGGREGATE(keys={'year': year}, aggregations={'agg_4': SUM(expr_3), 'agg_7': SUM(expr_6)})
     PROJECT(columns={'expr_3': expr_3, 'expr_6': agg_5, 'year': year})
      JOIN(conditions=[t0.calendar_day == t1.calendar_day], types=['left'], columns={'agg_5': t1.agg_5, 'expr_3': t0.expr_3, 'year': t0.year})
       PROJECT(columns={'calendar_day': calendar_day, 'expr_3': agg_2, 'year': year})
        JOIN(conditions=[t0.calendar_day == t1.calendar_day], types=['left'], columns={'agg_2': t1.agg_2, 'calendar_day': t0.calendar_day, 'year': t0.year})
         PROJECT(columns={'calendar_day': calendar_day, 'year': YEAR(calendar_day)})
          SCAN(table=main.CALENDAR, columns={'calendar_day': ca_dt})
         AGGREGATE(keys={'calendar_day': calendar_day}, aggregations={'agg_2': COUNT()})
          JOIN(conditions=[t0.key_0 == DATETIME(t1.purchase_timestamp, 'start of day':string)], types=['inner'], columns={'calendar_day': t0.calendar_day})
           SCAN(table=main.CALENDAR, columns={'calendar_day': ca_dt, 'key_0': ca_dt})
           SCAN(table=main.DEVICES, columns={'purchase_timestamp': de_purchase_ts})
       AGGREGATE(keys={'calendar_day': calendar_day}, aggregations={'agg_5': COUNT()})
        JOIN(conditions=[t0.key_0 == DATETIME(t1.reported_timestamp, 'start of day':string)], types=['inner'], columns={'calendar_day': t0.calendar_day})
         SCAN(table=main.CALENDAR, columns={'calendar_day': ca_dt, 'key_0': ca_dt})
         SCAN(table=main.INCIDENTS, columns={'reported_timestamp': in_error_report_ts})
