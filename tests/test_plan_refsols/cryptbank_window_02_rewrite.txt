ROOT(columns=[('branch_name', b_name), ('key', UNMASK::(CASE WHEN [a_key] = 0 THEN 0 ELSE (CASE WHEN [a_key] > 0 THEN 1 ELSE -1 END) * CAST(SUBSTRING([a_key], 1 + INSTR([a_key], '-'), LENGTH([a_key]) / 2) AS INTEGER) END)), ('creation_timestamp', UNMASK::(DATETIME([a_open_ts], '+123456789 seconds')))], orderings=[(b_name):asc_first])
 FILTER(condition=RANKING(args=[], partition=[a_branchkey], order=[(ISIN(a_open_ts, ['2017-02-11 10:59:51', '2017-06-15 12:41:51', '2017-07-07 14:26:51', '2017-07-09 12:21:51', '2017-09-15 11:26:51', '2018-01-02 12:26:51']:array[unknown])):asc_last, (UNMASK::(CASE WHEN [a_key] = 0 THEN 0 ELSE (CASE WHEN [a_key] > 0 THEN 1 ELSE -1 END) * CAST(SUBSTRING([a_key], 1 + INSTR([a_key], '-'), LENGTH([a_key]) / 2) AS INTEGER) END)):asc_last], allow_ties=False) == 1:numeric, columns={'a_key': a_key, 'a_open_ts': a_open_ts, 'b_name': b_name})
  JOIN(condition=t0.b_key == t1.a_branchkey, type=INNER, cardinality=PLURAL_ACCESS, reverse_cardinality=SINGULAR_FILTER, columns={'a_branchkey': t1.a_branchkey, 'a_key': t1.a_key, 'a_open_ts': t1.a_open_ts, 'b_name': t0.b_name})
   FILTER(condition=CONTAINS(b_addr, ';CA;':string), columns={'b_key': b_key, 'b_name': b_name})
    SCAN(table=CRBNK.BRANCHES, columns={'b_addr': b_addr, 'b_key': b_key, 'b_name': b_name})
   SCAN(table=CRBNK.ACCOUNTS, columns={'a_branchkey': a_branchkey, 'a_key': a_key, 'a_open_ts': a_open_ts})
