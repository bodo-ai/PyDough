ROOT(columns=[('date_time', sbTxDateTime), ('txn_within_day', RELSIZE(args=[], partition=[DATETIME(sbTxDateTime, 'start of day':string)], order=[(sbTxDateTime):asc_last], cumulative=True)), ('n_buys_within_day', RELCOUNT(args=[KEEP_IF(sbTxType, (sbTxType == 'buy':string))], partition=[DATETIME(sbTxDateTime, 'start of day':string)], order=[(sbTxDateTime):asc_last], cumulative=True)), ('pct_apple_txns', ROUND(((100.0:numeric * RELSUM(args=[ISIN(sbTickerSymbol, ['AAPL', 'AMZN']:array[unknown])], partition=[], order=[(sbTxDateTime):asc_last], cumulative=True)) / RELSIZE(args=[], partition=[], order=[(sbTxDateTime):asc_last], cumulative=True)), 2:numeric)), ('share_change', RELSUM(args=[IFF((sbTxType == 'buy':string), sbTxShares, (0:numeric - sbTxShares))], partition=[], order=[(sbTxDateTime):asc_last], cumulative=True)), ('rolling_avg_amount', ROUND(RELAVG(args=[sbTxAmount], partition=[], order=[(sbTxDateTime):asc_last], cumulative=True), 2:numeric))], orderings=[(sbTxDateTime):asc_first])
 JOIN(condition=t0.sbTxTickerId == t1.sbTickerId, type=INNER, cardinality=SINGULAR_ACCESS, reverse_cardinality=PLURAL_FILTER, columns={'sbTickerSymbol': t1.sbTickerSymbol, 'sbTxAmount': t0.sbTxAmount, 'sbTxDateTime': t0.sbTxDateTime, 'sbTxShares': t0.sbTxShares, 'sbTxType': t0.sbTxType})
  FILTER(condition=(MONTH(sbTxDateTime) == 4:numeric) & (YEAR(sbTxDateTime) == 2023:numeric) & (sbTxStatus == 'success':string), columns={'sbTxAmount': sbTxAmount, 'sbTxDateTime': sbTxDateTime, 'sbTxShares': sbTxShares, 'sbTxTickerId': sbTxTickerId, 'sbTxType': sbTxType})
   SCAN(table=main.sbTransaction, columns={'sbTxAmount': sbTxAmount, 'sbTxDateTime': sbTxDateTime, 'sbTxShares': sbTxShares, 'sbTxStatus': sbTxStatus, 'sbTxTickerId': sbTxTickerId, 'sbTxType': sbTxType})
  SCAN(table=main.sbTicker, columns={'sbTickerId': sbTickerId, 'sbTickerSymbol': sbTickerSymbol})
