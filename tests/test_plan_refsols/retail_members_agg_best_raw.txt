ROOT(columns=[('store_location', UNMASK::(PTY_UNPROTECT_ADDRESS([store_location]))), ('total_amount', total_amount), ('name', JOIN_STRINGS(' ':string, UNMASK::(PTY_UNPROTECT([first_name], 'deName')), UNMASK::(PTY_UNPROTECT_NAME([last_name]))))], orderings=[(total_amount):desc_last], limit=5:numeric)
 FILTER(condition=1:numeric == RANKING(args=[], partition=[UNMASK::(PTY_UNPROTECT_ADDRESS([store_location]))], order=[(total_amount):desc_first], allow_ties=False), columns={'first_name': first_name, 'last_name': last_name, 'store_location': store_location, 'total_amount': total_amount})
  JOIN(condition=t0.customer_id == t1.customer_id, type=INNER, cardinality=SINGULAR_ACCESS, reverse_cardinality=PLURAL_FILTER, columns={'first_name': t1.first_name, 'last_name': t1.last_name, 'store_location': t0.store_location, 'total_amount': t0.total_amount})
   SCAN(table=bodo.retail.transactions, columns={'customer_id': customer_id, 'store_location': store_location, 'total_amount': total_amount})
   SCAN(table=bodo.retail.protected_loyalty_members, columns={'customer_id': customer_id, 'first_name': first_name, 'last_name': last_name})
