ROOT(columns=[('order_year', order_year), ('highest_priority', highest_priority), ('priority_pct', priority_pct)], orderings=[(order_year):asc_first])
 FILTER(condition=RANKING(args=[], partition=[order_year], order=[(priority_pct):desc_first]) == 1:numeric, columns={'highest_priority': highest_priority, 'order_year': order_year, 'priority_pct': priority_pct})
  PROJECT(columns={'highest_priority': order_priority, 'order_year': order_year, 'priority_pct': 100.0:numeric * n_orders / RELSUM(args=[n_orders], partition=[order_year], order=[])})
   PROJECT(columns={'n_orders': DEFAULT_TO(agg_0, 0:numeric), 'order_priority': order_priority, 'order_year': order_year})
    AGGREGATE(keys={'order_priority': order_priority, 'order_year': order_year}, aggregations={'agg_0': COUNT()})
     PROJECT(columns={'order_priority': order_priority, 'order_year': YEAR(order_date)})
      SCAN(table=tpch.ORDERS, columns={'order_date': o_orderdate, 'order_priority': o_orderpriority})
