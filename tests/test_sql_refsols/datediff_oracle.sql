SELECT
  sbtxdatetime AS x,
  TO_DATE('2025-05-02 11:00:00', 'YYYY-MM-DD HH24:MI:SS') AS y1,
  TO_DATE('2023-04-03 13:16:30', 'YYYY-MM-DD HH24:MI:SS') AS y,
  EXTRACT(YEAR FROM TO_DATE('2025-05-02 11:00:00', 'YYYY-MM-DD HH24:MI:SS')) - EXTRACT(YEAR FROM CAST(sbtxdatetime AS DATE)) AS years_diff,
  (
    EXTRACT(YEAR FROM TO_DATE('2025-05-02 11:00:00', 'YYYY-MM-DD HH24:MI:SS')) - EXTRACT(YEAR FROM CAST(sbtxdatetime AS DATE))
  ) * 12 + (
    EXTRACT(MONTH FROM TO_DATE('2025-05-02 11:00:00', 'YYYY-MM-DD HH24:MI:SS')) - EXTRACT(MONTH FROM CAST(sbtxdatetime AS DATE))
  ) AS months_diff,
  TO_DATE('2025-05-02 11:00:00', 'YYYY-MM-DD HH24:MI:SS') - CAST(sbtxdatetime AS DATE) AS days_diff,
  (
    TRUNC(CAST(TO_DATE('2025-05-02 11:00:00', 'YYYY-MM-DD HH24:MI:SS') AS DATETIME), 'HH24') - TRUNC(CAST(CAST(sbtxdatetime AS DATE) AS DATETIME), 'HH24')
  ) * 24 AS hours_diff,
  (
    TRUNC(CAST(TO_DATE('2023-04-03 13:16:30', 'YYYY-MM-DD HH24:MI:SS') AS DATETIME), 'MI') - TRUNC(CAST(CAST(sbtxdatetime AS DATE) AS DATETIME), 'MI')
  ) * 1440 AS minutes_diff,
  (
    TO_DATE('2023-04-03 13:16:30', 'YYYY-MM-DD HH24:MI:SS') - CAST(sbtxdatetime AS DATE)
  ) * 86400 AS seconds_diff
FROM MAIN.SBTRANSACTION
WHERE
  EXTRACT(YEAR FROM CAST(sbtxdatetime AS DATE)) < 2025
ORDER BY
  4 NULLS FIRST
FETCH FIRST 30 ROWS ONLY
