ROOT(columns=[('date_time', sbTxDateTime), ('s00', DATETIME(sbTxDateTime, 'start of week':string, '-8 weeks':string)), ('s01', KEEP_IF(False:bool, PRESENT(sbTxDateTime))), ('s02', ISIN(MONTH(sbTxDateTime), [1, 2, 3]:array[numeric])), ('s03', ISIN(MONTH(sbTxDateTime), [4, 5, 6]:array[numeric])), ('s04', ISIN(MONTH(sbTxDateTime), [7, 8, 9]:array[numeric])), ('s05', ISIN(MONTH(sbTxDateTime), [10, 11, 12]:array[numeric])), ('s06', KEEP_IF(False:bool, PRESENT(sbTxDateTime))), ('s07', KEEP_IF(False:bool, PRESENT(sbTxDateTime))), ('s08', MONTH(sbTxDateTime) < 4:numeric), ('s09', MONTH(sbTxDateTime) < 7:numeric), ('s10', MONTH(sbTxDateTime) < 10:numeric), ('s11', KEEP_IF(True:bool, PRESENT(sbTxDateTime))), ('s12', KEEP_IF(False:bool, PRESENT(sbTxDateTime))), ('s13', MONTH(sbTxDateTime) <= 3:numeric), ('s14', MONTH(sbTxDateTime) <= 6:numeric), ('s15', MONTH(sbTxDateTime) <= 9:numeric), ('s16', KEEP_IF(True:bool, PRESENT(sbTxDateTime))), ('s17', KEEP_IF(True:bool, PRESENT(sbTxDateTime))), ('s18', MONTH(sbTxDateTime) > 3:numeric), ('s19', MONTH(sbTxDateTime) > 6:numeric), ('s20', MONTH(sbTxDateTime) > 9:numeric), ('s21', KEEP_IF(False:bool, PRESENT(sbTxDateTime))), ('s22', KEEP_IF(True:bool, PRESENT(sbTxDateTime))), ('s23', MONTH(sbTxDateTime) >= 4:numeric), ('s24', MONTH(sbTxDateTime) >= 7:numeric), ('s25', MONTH(sbTxDateTime) >= 10:numeric), ('s26', KEEP_IF(False:bool, PRESENT(sbTxDateTime))), ('s27', KEEP_IF(True:bool, PRESENT(sbTxDateTime))), ('s28', NOT(ISIN(MONTH(sbTxDateTime), [1, 2, 3]:array[numeric]))), ('s29', NOT(ISIN(MONTH(sbTxDateTime), [4, 5, 6]:array[numeric]))), ('s30', NOT(ISIN(MONTH(sbTxDateTime), [7, 8, 9]:array[numeric]))), ('s31', NOT(ISIN(MONTH(sbTxDateTime), [10, 11, 12]:array[numeric]))), ('s32', KEEP_IF(True:bool, PRESENT(sbTxDateTime)))], orderings=[])
 FILTER(condition=RANKING(args=[], partition=[], order=[(sbTxDateTime):asc_last]) == 1:numeric | RANKING(args=[], partition=[], order=[(sbTxDateTime):desc_first]) == 1:numeric, columns={'sbTxDateTime': sbTxDateTime})
  FILTER(condition=YEAR(sbTxDateTime) == 2023:numeric, columns={'sbTxDateTime': sbTxDateTime})
   SCAN(table=main.sbTransaction, columns={'sbTxDateTime': sbTxDateTime})
