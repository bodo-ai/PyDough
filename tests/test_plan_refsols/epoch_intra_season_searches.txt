ROOT(columns=[('season_name', season_name), ('pct_season_searches', pct_season_searches), ('pct_event_searches', pct_event_searches)], orderings=[(season_name):asc_first])
 PROJECT(columns={'pct_event_searches': ROUND(100.0:numeric * DEFAULT_TO(agg_0, 0:numeric) / DEFAULT_TO(agg_1, 0:numeric), 2:numeric), 'pct_season_searches': ROUND(100.0:numeric * DEFAULT_TO(agg_2, 0:numeric) / agg_3, 2:numeric), 'season_name': agg_4})
  JOIN(condition=t0.agg_1 == t1.name, type=LEFT, cardinality=SINGULAR_ACCESS, columns={'agg_0': t1.agg_0, 'agg_1': t1.agg_1, 'agg_2': t0.agg_2, 'agg_3': t0.agg_3, 'agg_4': t0.agg_1})
   AGGREGATE(keys={'name': name}, aggregations={'agg_1': ANYTHING(name), 'agg_2': SUM(is_intra_season), 'agg_3': COUNT()})
    PROJECT(columns={'is_intra_season': DEFAULT_TO(agg_0, 0:numeric) > 0:numeric, 'name': name})
     JOIN(condition=t0.name == t1.name & t0.search_id == t1.search_id, type=LEFT, cardinality=SINGULAR_ACCESS, columns={'agg_0': t1.agg_0, 'name': t0.name})
      JOIN(condition=MONTH(t1.search_ts) == t0.s_month1 | MONTH(t1.search_ts) == t0.s_month2 | MONTH(t1.search_ts) == t0.s_month3, type=INNER, cardinality=PLURAL_ACCESS, columns={'name': t0.s_name, 'search_id': t1.search_id})
       SCAN(table=SEASONS, columns={'s_month1': s_month1, 's_month2': s_month2, 's_month3': s_month3, 's_name': s_name})
       SCAN(table=SEARCHES, columns={'search_id': search_id, 'search_ts': search_ts})
      AGGREGATE(keys={'name': name, 'search_id': search_id}, aggregations={'agg_0': COUNT()})
       JOIN(condition=t1.s_name == t0.name & MONTH(t0.date_time) == t1.s_month1 | MONTH(t0.date_time) == t1.s_month2 | MONTH(t0.date_time) == t1.s_month3, type=INNER, cardinality=SINGULAR_UNKNOWN, columns={'name': t0.name, 'search_id': t0.search_id})
        JOIN(condition=CONTAINS(LOWER(t0.search_string), LOWER(t1.ev_name)), type=INNER, cardinality=PLURAL_FILTER, columns={'date_time': t1.ev_dt, 'name': t0.name, 'search_id': t0.search_id})
         JOIN(condition=MONTH(t1.search_ts) == t0.s_month1 | MONTH(t1.search_ts) == t0.s_month2 | MONTH(t1.search_ts) == t0.s_month3, type=INNER, cardinality=PLURAL_ACCESS, columns={'name': t0.s_name, 'search_id': t1.search_id, 'search_string': t1.search_string})
          SCAN(table=SEASONS, columns={'s_month1': s_month1, 's_month2': s_month2, 's_month3': s_month3, 's_name': s_name})
          SCAN(table=SEARCHES, columns={'search_id': search_id, 'search_string': search_string, 'search_ts': search_ts})
         SCAN(table=EVENTS, columns={'ev_dt': ev_dt, 'ev_name': ev_name})
        SCAN(table=SEASONS, columns={'s_month1': s_month1, 's_month2': s_month2, 's_month3': s_month3, 's_name': s_name})
   AGGREGATE(keys={'name': name}, aggregations={'agg_0': SUM(is_intra_season), 'agg_1': COUNT()})
    PROJECT(columns={'is_intra_season': s_name == name, 'name': name})
     JOIN(condition=MONTH(t0.search_ts) == t1.s_month1 | MONTH(t0.search_ts) == t1.s_month2 | MONTH(t0.search_ts) == t1.s_month3, type=INNER, cardinality=SINGULAR_ACCESS, columns={'name': t0.name, 's_name': t1.s_name})
      JOIN(condition=CONTAINS(LOWER(t1.search_string), LOWER(t0.ev_name)), type=INNER, cardinality=PLURAL_FILTER, columns={'name': t0.name, 'search_ts': t1.search_ts})
       JOIN(condition=MONTH(t1.ev_dt) == t0.s_month1 | MONTH(t1.ev_dt) == t0.s_month2 | MONTH(t1.ev_dt) == t0.s_month3, type=INNER, cardinality=PLURAL_ACCESS, columns={'ev_name': t1.ev_name, 'name': t0.s_name})
        SCAN(table=SEASONS, columns={'s_month1': s_month1, 's_month2': s_month2, 's_month3': s_month3, 's_name': s_name})
        SCAN(table=EVENTS, columns={'ev_dt': ev_dt, 'ev_name': ev_name})
       SCAN(table=SEARCHES, columns={'search_string': search_string, 'search_ts': search_ts})
      SCAN(table=SEASONS, columns={'s_month1': s_month1, 's_month2': s_month2, 's_month3': s_month3, 's_name': s_name})
