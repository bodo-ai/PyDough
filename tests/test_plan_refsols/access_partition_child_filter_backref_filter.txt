ROOT(columns=[('part_name', part_name), ('part_type', part_type_4), ('retail_price', retail_price)], orderings=[])
 PROJECT(columns={'part_name': part_name, 'part_type_4': part_type_3, 'retail_price': retail_price})
  FILTER(condition=retail_price < avg_price, columns={'part_name': part_name, 'part_type_3': part_type_3, 'retail_price': retail_price})
   PROJECT(columns={'avg_price': avg_price, 'part_name': name, 'part_type_3': part_type_1, 'retail_price': retail_price})
    JOIN(conditions=[t0.part_type == t1.part_type], types=['inner'], columns={'avg_price': t0.avg_price, 'name': t1.name, 'part_type_1': t1.part_type, 'retail_price': t1.retail_price})
     PROJECT(columns={'avg_price': agg_0, 'part_type': part_type})
      AGGREGATE(keys={'part_type': part_type}, aggregations={'agg_0': AVG(retail_price)})
       SCAN(table=tpch.PART, columns={'part_type': p_type, 'retail_price': p_retailprice})
     SCAN(table=tpch.PART, columns={'name': p_name, 'part_type': p_type, 'retail_price': p_retailprice})
