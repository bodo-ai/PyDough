ROOT(columns=[('tod', t_name), ('search_engine', search_engine), ('n_searches', n_rows)], orderings=[(t_name):asc_first])
 FILTER(condition=1:numeric == RANKING(args=[], partition=[t_name], order=[(n_rows):desc_first, (search_engine):asc_last], allow_ties=False), columns={'n_rows': n_rows, 'search_engine': search_engine, 't_name': t_name})
  AGGREGATE(keys={'search_engine': search_engine, 't_name': t_name}, aggregations={'n_rows': COUNT()})
   JOIN(condition=(t0.t_start_hour <= HOUR(t1.search_ts)) & (HOUR(t1.search_ts) < t0.t_end_hour), type=INNER, cardinality=PLURAL_ACCESS, reverse_cardinality=SINGULAR_ACCESS, columns={'search_engine': t1.search_engine, 't_name': t0.t_name})
    SCAN(table=TIMES, columns={'t_end_hour': t_end_hour, 't_name': t_name, 't_start_hour': t_start_hour})
    SCAN(table=SEARCHES, columns={'search_engine': search_engine, 'search_ts': search_ts})
