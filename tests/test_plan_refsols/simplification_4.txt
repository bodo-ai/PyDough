ROOT(columns=[('date_time', sbTxDateTime), ('s00', DATETIME(sbTxDateTime, 'start of week':string, '-8 weeks':string)), ('s01', KEEP_IF(False:bool, PRESENT(sbTxDateTime))), ('s02', ISIN(MONTH(sbTxDateTime), [1, 2, 3]:array[numeric])), ('s03', ISIN(MONTH(sbTxDateTime), [4, 5, 6]:array[numeric])), ('s04', ISIN(MONTH(sbTxDateTime), [7, 8, 9]:array[numeric])), ('s05', ISIN(MONTH(sbTxDateTime), [10, 11, 12]:array[numeric])), ('s06', KEEP_IF(False:bool, PRESENT(sbTxDateTime))), ('s07', KEEP_IF(False:bool, PRESENT(sbTxDateTime))), ('s08', MONTH(sbTxDateTime) < 4:numeric), ('s09', MONTH(sbTxDateTime) < 7:numeric), ('s10', MONTH(sbTxDateTime) < 10:numeric), ('s11', KEEP_IF(True:bool, PRESENT(sbTxDateTime))), ('s12', KEEP_IF(False:bool, PRESENT(sbTxDateTime))), ('s13', MONTH(sbTxDateTime) <= 3:numeric), ('s14', MONTH(sbTxDateTime) <= 6:numeric), ('s15', MONTH(sbTxDateTime) <= 9:numeric), ('s16', KEEP_IF(True:bool, PRESENT(sbTxDateTime))), ('s17', KEEP_IF(True:bool, PRESENT(sbTxDateTime))), ('s18', MONTH(sbTxDateTime) > 3:numeric), ('s19', MONTH(sbTxDateTime) > 6:numeric), ('s20', MONTH(sbTxDateTime) > 9:numeric), ('s21', KEEP_IF(False:bool, PRESENT(sbTxDateTime))), ('s22', KEEP_IF(True:bool, PRESENT(sbTxDateTime))), ('s23', MONTH(sbTxDateTime) >= 4:numeric), ('s24', MONTH(sbTxDateTime) >= 7:numeric), ('s25', MONTH(sbTxDateTime) >= 10:numeric), ('s26', KEEP_IF(False:bool, PRESENT(sbTxDateTime))), ('s27', KEEP_IF(True:bool, PRESENT(sbTxDateTime))), ('s28', NOT(ISIN(MONTH(sbTxDateTime), [1, 2, 3]:array[numeric]))), ('s29', NOT(ISIN(MONTH(sbTxDateTime), [4, 5, 6]:array[numeric]))), ('s30', NOT(ISIN(MONTH(sbTxDateTime), [7, 8, 9]:array[numeric]))), ('s31', NOT(ISIN(MONTH(sbTxDateTime), [10, 11, 12]:array[numeric]))), ('s32', KEEP_IF(True:bool, PRESENT(sbTxDateTime))), ('s33', 2024:numeric), ('s34', 3:numeric), ('s35', 8:numeric), ('s36', 13:numeric), ('s37', 12:numeric), ('s38', 45:numeric), ('s39', 59:numeric), ('s40', 2020:numeric), ('s41', 1:numeric), ('s42', 1:numeric), ('s43', 31:numeric), ('s44', 0:numeric), ('s45', 0:numeric), ('s46', 0:numeric), ('s47', 2023:numeric), ('s48', 3:numeric), ('s49', 7:numeric), ('s50', 4:numeric), ('s51', 6:numeric), ('s52', 55:numeric), ('s53', 0:numeric), ('s54', 1999:numeric), ('s55', 4:numeric), ('s56', 12:numeric), ('s57', 31:numeric), ('s58', 23:numeric), ('s59', 59:numeric), ('s60', 58:numeric)], orderings=[])
 FILTER(condition=RANKING(args=[], partition=[], order=[(sbTxDateTime):asc_last]) == 1:numeric | RANKING(args=[], partition=[], order=[(sbTxDateTime):desc_first]) == 1:numeric, columns={'sbTxDateTime': sbTxDateTime})
  FILTER(condition=YEAR(sbTxDateTime) == 2023:numeric, columns={'sbTxDateTime': sbTxDateTime})
   SCAN(table=main.sbTransaction, columns={'sbTxDateTime': sbTxDateTime})
