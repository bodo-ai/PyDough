ROOT(columns=[('order_key', order_key), ('max_ratio', max_ratio)], orderings=[])
 JOIN(conditions=[t0.order_key == t1.order_key], types=['inner'], columns={'max_ratio': t1.max_ratio, 'order_key': t0.order_key})
  SCAN(table=tpch.ORDERS, columns={'order_key': o_orderkey})
  AGGREGATE(keys={'order_key': order_key}, aggregations={'max_ratio': MAX(ratio)})
   PROJECT(columns={'order_key': order_key, 'ratio': quantity / available_quantity})
    JOIN(conditions=[t0.part_key == t1.part_key & t0.supplier_key == t1.supplier_key], types=['inner'], columns={'available_quantity': t1.available_quantity, 'order_key': t0.order_key, 'quantity': t0.quantity})
     SCAN(table=tpch.LINEITEM, columns={'order_key': l_orderkey, 'part_key': l_partkey, 'quantity': l_quantity, 'supplier_key': l_suppkey})
     SCAN(table=tpch.PARTSUPP, columns={'available_quantity': ps_availqty, 'part_key': ps_partkey, 'supplier_key': ps_suppkey})
