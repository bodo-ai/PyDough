ROOT(columns=[('date_time', date_time)], orderings=[(date_time):asc_first])
 FILTER(condition=RANKING(args=[], partition=[txn_day], order=[(pct_of_day):asc_last], allow_ties=False) == 1:numeric, columns={'date_time': date_time})
  FILTER(condition=pct_of_day >= 50.0:numeric, columns={'date_time': date_time, 'pct_of_day': pct_of_day, 'txn_day': txn_day})
   PROJECT(columns={'date_time': date_time, 'pct_of_day': 100.0:numeric * RELSUM(args=[sbTxShares], partition=[txn_day], order=[(date_time):asc_last], cumulative=True) / RELSUM(args=[sbTxShares], partition=[txn_day], order=[]), 'txn_day': txn_day})
    PROJECT(columns={'date_time': date_time, 'sbTxShares': sbTxShares, 'txn_day': DATETIME(date_time, 'start of day':string)})
     FILTER(condition=YEAR(sbTxDateTime) == 2023:numeric, columns={'date_time': sbTxDateTime, 'sbTxShares': sbTxShares})
      SCAN(table=main.sbTransaction, columns={'sbTxDateTime': sbTxDateTime, 'sbTxShares': sbTxShares})
