ROOT(columns=[('years_since_release', year_ca_dt - YEAR(anything_pr_release)), ('cum_ir', ROUND(RELSUM(args=[DEFAULT_TO(sum_expr, 0:numeric)], partition=[], order=[(year_ca_dt):asc_last], cumulative=True) / RELSUM(args=[DEFAULT_TO(sum_n_rows, 0:numeric)], partition=[], order=[(year_ca_dt):asc_last], cumulative=True), 2:numeric)), ('pct_bought_change', ROUND(100.0:numeric * DEFAULT_TO(sum_n_rows, 0:numeric) - PREV(args=[DEFAULT_TO(sum_n_rows, 0:numeric)], partition=[], order=[(year_ca_dt):asc_last]) / PREV(args=[DEFAULT_TO(sum_n_rows, 0:numeric)], partition=[], order=[(year_ca_dt):asc_last]), 2:numeric)), ('pct_incident_change', ROUND(100.0:numeric * DEFAULT_TO(sum_expr, 0:numeric) - PREV(args=[DEFAULT_TO(sum_expr, 0:numeric)], partition=[], order=[(year_ca_dt):asc_last]) / PREV(args=[DEFAULT_TO(sum_expr, 0:numeric)], partition=[], order=[(year_ca_dt):asc_last]), 2:numeric)), ('bought', DEFAULT_TO(sum_n_rows, 0:numeric)), ('incidents', DEFAULT_TO(sum_expr, 0:numeric))], orderings=[(year_ca_dt - YEAR(anything_pr_release)):asc_first])
 JOIN(condition=YEAR(t0.anything_pr_release) <= t1.year_ca_dt, type=INNER, cardinality=SINGULAR_FILTER, reverse_cardinality=PLURAL_FILTER, columns={'anything_pr_release': t0.anything_pr_release, 'sum_expr': t1.sum_expr_4, 'sum_n_rows': t1.sum_n_rows, 'year_ca_dt': t1.year_ca_dt})
  AGGREGATE(keys={}, aggregations={'anything_pr_release': ANYTHING(pr_release)})
   FILTER(condition=pr_name == 'GoldCopper-Star':string, columns={'pr_release': pr_release})
    SCAN(table=main.PRODUCTS, columns={'pr_name': pr_name, 'pr_release': pr_release})
  AGGREGATE(keys={'year_ca_dt': YEAR(ca_dt)}, aggregations={'sum_expr_4': SUM(expr_4), 'sum_n_rows': SUM(n_rows)})
   JOIN(condition=t0.ca_dt == t1.ca_dt, type=LEFT, cardinality=SINGULAR_FILTER, reverse_cardinality=SINGULAR_ACCESS, columns={'ca_dt': t0.ca_dt, 'expr_4': t0.n_rows, 'n_rows': t1.n_rows})
    JOIN(condition=t0.ca_dt == t1.ca_dt, type=LEFT, cardinality=SINGULAR_FILTER, reverse_cardinality=SINGULAR_ACCESS, columns={'ca_dt': t0.ca_dt, 'n_rows': t1.n_rows})
     SCAN(table=main.CALENDAR, columns={'ca_dt': ca_dt})
     AGGREGATE(keys={'ca_dt': ca_dt}, aggregations={'n_rows': COUNT()})
      JOIN(condition=t0.de_product_id == t1.pr_id, type=INNER, cardinality=SINGULAR_FILTER, reverse_cardinality=PLURAL_FILTER, columns={'ca_dt': t0.ca_dt})
       JOIN(condition=t0.in_device_id == t1.de_id, type=INNER, cardinality=SINGULAR_ACCESS, reverse_cardinality=PLURAL_FILTER, columns={'ca_dt': t0.ca_dt, 'de_product_id': t1.de_product_id})
        JOIN(condition=t0.ca_dt == DATETIME(t1.in_error_report_ts, 'start of day':string), type=INNER, cardinality=PLURAL_FILTER, reverse_cardinality=SINGULAR_FILTER, columns={'ca_dt': t0.ca_dt, 'in_device_id': t1.in_device_id})
         SCAN(table=main.CALENDAR, columns={'ca_dt': ca_dt})
         SCAN(table=main.INCIDENTS, columns={'in_device_id': in_device_id, 'in_error_report_ts': in_error_report_ts})
        SCAN(table=main.DEVICES, columns={'de_id': de_id, 'de_product_id': de_product_id})
       FILTER(condition=pr_name == 'GoldCopper-Star':string, columns={'pr_id': pr_id})
        SCAN(table=main.PRODUCTS, columns={'pr_id': pr_id, 'pr_name': pr_name})
    AGGREGATE(keys={'ca_dt': ca_dt}, aggregations={'n_rows': COUNT()})
     JOIN(condition=t0.de_product_id == t1.pr_id, type=INNER, cardinality=SINGULAR_FILTER, reverse_cardinality=PLURAL_FILTER, columns={'ca_dt': t0.ca_dt})
      JOIN(condition=t0.ca_dt == DATETIME(t1.de_purchase_ts, 'start of day':string), type=INNER, cardinality=PLURAL_FILTER, reverse_cardinality=SINGULAR_FILTER, columns={'ca_dt': t0.ca_dt, 'de_product_id': t1.de_product_id})
       SCAN(table=main.CALENDAR, columns={'ca_dt': ca_dt})
       SCAN(table=main.DEVICES, columns={'de_product_id': de_product_id, 'de_purchase_ts': de_purchase_ts})
      FILTER(condition=pr_name == 'GoldCopper-Star':string, columns={'pr_id': pr_id})
       SCAN(table=main.PRODUCTS, columns={'pr_id': pr_id, 'pr_name': pr_name})
