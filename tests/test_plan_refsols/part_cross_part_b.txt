ROOT(columns=[('state', sbCustState), ('month_of_year', month), ('n', RELSUM(args=[DEFAULT_TO(n_rows, 0:numeric)], partition=[sbCustState], order=[(month):asc_last], cumulative=True))], orderings=[(sbCustState):asc_first, (month):asc_first])
 JOIN(condition=t0.sbCustState == t1.sbCustState & t0.month == t1.month, type=LEFT, cardinality=SINGULAR_FILTER, columns={'month': t0.month, 'n_rows': t1.n_rows, 'sbCustState': t0.sbCustState})
  JOIN(condition=True:bool, type=LEFT, cardinality=SINGULAR_FILTER, columns={'month': t1.month, 'sbCustState': t0.sbCustState})
   AGGREGATE(keys={'sbCustState': sbCustState}, aggregations={})
    SCAN(table=main.sbCustomer, columns={'sbCustState': sbCustState})
   AGGREGATE(keys={'month': DATETIME(sbTxDateTime, 'start of month':string)}, aggregations={})
    FILTER(condition=YEAR(sbTxDateTime) == 2023:numeric, columns={'sbTxDateTime': sbTxDateTime})
     SCAN(table=main.sbTransaction, columns={'sbTxDateTime': sbTxDateTime})
  AGGREGATE(keys={'month': month, 'sbCustState': sbCustState}, aggregations={'n_rows': COUNT()})
   JOIN(condition=t0.sbTxCustId == t1.sbCustId & t1.sbCustState == t0.sbCustState, type=INNER, cardinality=SINGULAR_FILTER, columns={'month': t0.month, 'sbCustState': t0.sbCustState})
    JOIN(condition=t0.month == DATETIME(t1.sbTxDateTime, 'start of month':string), type=INNER, cardinality=PLURAL_FILTER, columns={'month': t0.month, 'sbCustState': t0.sbCustState, 'sbTxCustId': t1.sbTxCustId})
     JOIN(condition=True:bool, type=LEFT, cardinality=SINGULAR_FILTER, columns={'month': t1.month, 'sbCustState': t0.sbCustState})
      AGGREGATE(keys={'sbCustState': sbCustState}, aggregations={})
       SCAN(table=main.sbCustomer, columns={'sbCustState': sbCustState})
      AGGREGATE(keys={'month': DATETIME(sbTxDateTime, 'start of month':string)}, aggregations={})
       FILTER(condition=YEAR(sbTxDateTime) == 2023:numeric, columns={'sbTxDateTime': sbTxDateTime})
        SCAN(table=main.sbTransaction, columns={'sbTxDateTime': sbTxDateTime})
     FILTER(condition=YEAR(sbTxDateTime) == 2023:numeric, columns={'sbTxCustId': sbTxCustId, 'sbTxDateTime': sbTxDateTime})
      SCAN(table=main.sbTransaction, columns={'sbTxCustId': sbTxCustId, 'sbTxDateTime': sbTxDateTime})
    SCAN(table=main.sbCustomer, columns={'sbCustId': sbCustId, 'sbCustState': sbCustState})
