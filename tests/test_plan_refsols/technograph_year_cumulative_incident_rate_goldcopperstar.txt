ROOT(columns=[('years_since_release', years_since_release), ('cum_ir', cum_ir), ('pct_bought_change', pct_bought_change), ('pct_incident_change', pct_incident_change), ('bought', n_devices), ('incidents', n_incidents)], orderings=[(years_since_release):asc_first])
 PROJECT(columns={'cum_ir': ROUND(RELSUM(args=[n_incidents], partition=[], order=[(year):asc_last], cumulative=True) / RELSUM(args=[n_devices], partition=[], order=[(year):asc_last], cumulative=True), 2:numeric), 'n_devices': n_devices, 'n_incidents': n_incidents, 'pct_bought_change': ROUND(100.0:numeric * n_devices - PREV(args=[n_devices], partition=[], order=[(year):asc_last]) / PREV(args=[n_devices], partition=[], order=[(year):asc_last]), 2:numeric), 'pct_incident_change': ROUND(100.0:numeric * n_incidents - PREV(args=[n_incidents], partition=[], order=[(year):asc_last]) / PREV(args=[n_incidents], partition=[], order=[(year):asc_last]), 2:numeric), 'years_since_release': year - YEAR(anything_pr_release)})
  PROJECT(columns={'anything_pr_release': anything_pr_release, 'n_devices': DEFAULT_TO(sum_agg_6, 0:numeric), 'n_incidents': DEFAULT_TO(sum_agg_3, 0:numeric), 'year': year})
   FILTER(condition=YEAR(anything_pr_release) <= year, columns={'anything_pr_release': anything_pr_release, 'sum_agg_3': sum_agg_3, 'sum_agg_6': sum_agg_6, 'year': year})
    JOIN(condition=True:bool, type=INNER, cardinality=SINGULAR_ACCESS, columns={'anything_pr_release': t0.anything_pr_release, 'sum_agg_3': t1.sum_agg_3, 'sum_agg_6': t1.sum_agg_6, 'year': t1.year})
     AGGREGATE(keys={}, aggregations={'anything_pr_release': ANYTHING(pr_release)})
      FILTER(condition=pr_name == 'GoldCopper-Star':string, columns={'pr_release': pr_release})
       SCAN(table=main.PRODUCTS, columns={'pr_name': pr_name, 'pr_release': pr_release})
     AGGREGATE(keys={'year': year}, aggregations={'sum_agg_3': SUM(agg_3), 'sum_agg_6': SUM(agg_6)})
      JOIN(condition=t0.ca_dt == t1.calendar_day, type=LEFT, cardinality=SINGULAR_ACCESS, columns={'agg_3': t0.agg_3, 'agg_6': t1.agg_6, 'year': t0.year})
       JOIN(condition=t0.ca_dt == t1.calendar_day, type=LEFT, cardinality=SINGULAR_ACCESS, columns={'agg_3': t1.agg_3, 'ca_dt': t0.ca_dt, 'year': t0.year})
        PROJECT(columns={'ca_dt': ca_dt, 'year': YEAR(ca_dt)})
         SCAN(table=main.CALENDAR, columns={'ca_dt': ca_dt})
        AGGREGATE(keys={'calendar_day': ca_dt}, aggregations={'agg_3': COUNT()})
         JOIN(condition=t0.de_product_id == t1.pr_id, type=INNER, cardinality=SINGULAR_FILTER, columns={'ca_dt': t0.ca_dt})
          JOIN(condition=t0.in_device_id == t1.de_id, type=INNER, cardinality=SINGULAR_ACCESS, columns={'ca_dt': t0.ca_dt, 'de_product_id': t1.de_product_id})
           JOIN(condition=t0.ca_dt == DATETIME(t1.in_error_report_ts, 'start of day':string), type=INNER, cardinality=PLURAL_FILTER, columns={'ca_dt': t0.ca_dt, 'in_device_id': t1.in_device_id})
            SCAN(table=main.CALENDAR, columns={'ca_dt': ca_dt})
            SCAN(table=main.INCIDENTS, columns={'in_device_id': in_device_id, 'in_error_report_ts': in_error_report_ts})
           SCAN(table=main.DEVICES, columns={'de_id': de_id, 'de_product_id': de_product_id})
          FILTER(condition=pr_name == 'GoldCopper-Star':string, columns={'pr_id': pr_id})
           SCAN(table=main.PRODUCTS, columns={'pr_id': pr_id, 'pr_name': pr_name})
       AGGREGATE(keys={'calendar_day': ca_dt}, aggregations={'agg_6': COUNT()})
        JOIN(condition=t0.de_product_id == t1.pr_id, type=INNER, cardinality=SINGULAR_FILTER, columns={'ca_dt': t0.ca_dt})
         JOIN(condition=t0.ca_dt == DATETIME(t1.de_purchase_ts, 'start of day':string), type=INNER, cardinality=PLURAL_FILTER, columns={'ca_dt': t0.ca_dt, 'de_product_id': t1.de_product_id})
          SCAN(table=main.CALENDAR, columns={'ca_dt': ca_dt})
          SCAN(table=main.DEVICES, columns={'de_product_id': de_product_id, 'de_purchase_ts': de_purchase_ts})
         FILTER(condition=pr_name == 'GoldCopper-Star':string, columns={'pr_id': pr_id})
          SCAN(table=main.PRODUCTS, columns={'pr_id': pr_id, 'pr_name': pr_name})
