ROOT(columns=[('L_RETURNFLAG', return_flag), ('L_LINESTATUS', status), ('SUM_QTY', SUM_QTY), ('SUM_BASE_PRICE', SUM_BASE_PRICE), ('SUM_DISC_PRICE', SUM_DISC_PRICE), ('SUM_CHARGE', SUM_CHARGE), ('AVG_QTY', avg_l_quantity), ('AVG_PRICE', avg_l_extendedprice), ('AVG_DISC', avg_l_discount), ('COUNT_ORDER', n_rows)], orderings=[(return_flag):asc_first, (status):asc_first])
 PROJECT(columns={'SUM_BASE_PRICE': DEFAULT_TO(sum_l_extendedprice, 0:numeric), 'SUM_CHARGE': DEFAULT_TO(sum_expr_8, 0:numeric), 'SUM_DISC_PRICE': DEFAULT_TO(sum_expr_9, 0:numeric), 'SUM_QTY': DEFAULT_TO(sum_l_quantity, 0:numeric), 'avg_l_discount': avg_l_discount, 'avg_l_extendedprice': avg_l_extendedprice, 'avg_l_quantity': avg_l_quantity, 'n_rows': n_rows, 'return_flag': return_flag, 'status': status})
  AGGREGATE(keys={'return_flag': l_returnflag, 'status': l_linestatus}, aggregations={'avg_l_discount': AVG(l_discount), 'avg_l_extendedprice': AVG(l_extendedprice), 'avg_l_quantity': AVG(l_quantity), 'n_rows': COUNT(), 'sum_expr_8': SUM(expr_8), 'sum_expr_9': SUM(expr_9), 'sum_l_extendedprice': SUM(l_extendedprice), 'sum_l_quantity': SUM(l_quantity)})
   PROJECT(columns={'expr_8': l_extendedprice * 1:numeric - l_discount * 1:numeric + l_tax, 'expr_9': l_extendedprice * 1:numeric - l_discount, 'l_discount': l_discount, 'l_extendedprice': l_extendedprice, 'l_linestatus': l_linestatus, 'l_quantity': l_quantity, 'l_returnflag': l_returnflag})
    FILTER(condition=l_shipdate <= datetime.date(1998, 12, 1):datetime, columns={'l_discount': l_discount, 'l_extendedprice': l_extendedprice, 'l_linestatus': l_linestatus, 'l_quantity': l_quantity, 'l_returnflag': l_returnflag, 'l_tax': l_tax})
     SCAN(table=tpch.LINEITEM, columns={'l_discount': l_discount, 'l_extendedprice': l_extendedprice, 'l_linestatus': l_linestatus, 'l_quantity': l_quantity, 'l_returnflag': l_returnflag, 'l_shipdate': l_shipdate, 'l_tax': l_tax})
