ROOT(columns=[('S_SUPPKEY', S_SUPPKEY), ('S_NAME', S_NAME), ('S_ADDRESS', S_ADDRESS), ('S_PHONE', S_PHONE), ('TOTAL_REVENUE', TOTAL_REVENUE)], orderings=[(ordering_2):asc_first])
 PROJECT(columns={'S_ADDRESS': S_ADDRESS, 'S_NAME': S_NAME, 'S_PHONE': S_PHONE, 'S_SUPPKEY': S_SUPPKEY, 'TOTAL_REVENUE': TOTAL_REVENUE, 'ordering_2': S_SUPPKEY})
  FILTER(condition=TOTAL_REVENUE == max_revenue, columns={'S_ADDRESS': S_ADDRESS, 'S_NAME': S_NAME, 'S_PHONE': S_PHONE, 'S_SUPPKEY': S_SUPPKEY, 'TOTAL_REVENUE': TOTAL_REVENUE})
   PROJECT(columns={'S_ADDRESS': address, 'S_NAME': name, 'S_PHONE': phone, 'S_SUPPKEY': key, 'TOTAL_REVENUE': DEFAULT_TO(agg_1, 0:int64), 'max_revenue': max_revenue})
    JOIN(conditions=[t0.key == t1.supplier_key], types=['left'], columns={'address': t0.address, 'agg_1': t1.agg_1, 'key': t0.key, 'max_revenue': t0.max_revenue, 'name': t0.name, 'phone': t0.phone})
     JOIN(conditions=[True:bool], types=['inner'], columns={'address': t1.address, 'key': t1.key, 'max_revenue': t0.max_revenue, 'name': t1.name, 'phone': t1.phone})
      PROJECT(columns={'max_revenue': agg_0})
       AGGREGATE(keys={}, aggregations={'agg_0': MAX(total_revenue)})
        PROJECT(columns={'total_revenue': DEFAULT_TO(agg_0, 0:int64)})
         JOIN(conditions=[t0.key == t1.supplier_key], types=['left'], columns={'agg_0': t1.agg_0})
          SCAN(table=tpch.SUPPLIER, columns={'key': s_suppkey})
          AGGREGATE(keys={'supplier_key': supplier_key}, aggregations={'agg_0': SUM(extended_price * 1:int64 - discount)})
           FILTER(condition=ship_date < datetime.date(1996, 4, 1):date & ship_date >= datetime.date(1996, 1, 1):date, columns={'discount': discount, 'extended_price': extended_price, 'supplier_key': supplier_key})
            SCAN(table=tpch.LINEITEM, columns={'discount': l_discount, 'extended_price': l_extendedprice, 'ship_date': l_shipdate, 'supplier_key': l_suppkey})
      SCAN(table=tpch.SUPPLIER, columns={'address': s_address, 'key': s_suppkey, 'name': s_name, 'phone': s_phone})
     AGGREGATE(keys={'supplier_key': supplier_key}, aggregations={'agg_1': SUM(extended_price * 1:int64 - discount)})
      FILTER(condition=ship_date < datetime.date(1996, 4, 1):date & ship_date >= datetime.date(1996, 1, 1):date, columns={'discount': discount, 'extended_price': extended_price, 'supplier_key': supplier_key})
       SCAN(table=tpch.LINEITEM, columns={'discount': l_discount, 'extended_price': l_extendedprice, 'ship_date': l_shipdate, 'supplier_key': l_suppkey})
