ROOT(columns=[('size', size), ('best_order_priority', order_priority), ('best_order_priority_qty', total_qty)], orderings=[])
 JOIN(conditions=[t0.size == t1.size], types=['left'], columns={'order_priority': t1.order_priority, 'size': t0.size, 'total_qty': t1.total_qty})
  AGGREGATE(keys={'size': size}, aggregations={})
   SCAN(table=tpch.PART, columns={'size': p_size})
  FILTER(condition=RANKING(args=[], partition=[size], order=[(total_qty):desc_first], allow_ties=False) == 1:numeric, columns={'order_priority': order_priority, 'size': size, 'total_qty': total_qty})
   PROJECT(columns={'order_priority': order_priority, 'size': size, 'total_qty': DEFAULT_TO(agg_0, 0:numeric)})
    JOIN(conditions=[True:bool], types=['left'], columns={'agg_0': t1.agg_0, 'order_priority': t1.order_priority, 'size': t0.size})
     AGGREGATE(keys={'size': size}, aggregations={})
      SCAN(table=tpch.PART, columns={'size': p_size})
     AGGREGATE(keys={'order_priority': order_priority}, aggregations={'agg_0': SUM(psize)})
      PROJECT(columns={'order_priority': order_priority, 'psize': size})
       JOIN(conditions=[t0.part_key == t1.key], types=['left'], columns={'order_priority': t0.order_priority, 'size': t1.size})
        JOIN(conditions=[t0.key == t1.order_key], types=['inner'], columns={'order_priority': t0.order_priority, 'part_key': t1.part_key})
         FILTER(condition=YEAR(order_date) == 1998:numeric, columns={'key': key, 'order_priority': order_priority})
          SCAN(table=tpch.ORDERS, columns={'key': o_orderkey, 'order_date': o_orderdate, 'order_priority': o_orderpriority})
         SCAN(table=tpch.LINEITEM, columns={'order_key': l_orderkey, 'part_key': l_partkey})
        SCAN(table=tpch.PART, columns={'key': p_partkey, 'size': p_size})
