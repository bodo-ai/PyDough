WITH _t1 AS (
  SELECT
    sbtxdatetime
  FROM main.sbtransaction
  WHERE
    YEAR(CAST(sbtxdatetime AS TIMESTAMP)) = 2023
  QUALIFY
    ROW_NUMBER() OVER (ORDER BY sbtxdatetime DESC) = 1
    OR ROW_NUMBER() OVER (ORDER BY sbtxdatetime) = 1
)
SELECT
  sbtxdatetime AS date_time,
  DATEADD(
    WEEK,
    -8,
    DATE_TRUNC(
      'DAY',
      DATEADD(
        DAY,
        (
          (
            DAYOFWEEK(CAST(sbtxdatetime AS TIMESTAMP)) + 6
          ) % 7
        ) * -1,
        CAST(sbtxdatetime AS TIMESTAMP)
      )
    )
  ) AS s00,
  FALSE AS s01,
  MONTH(CAST(sbtxdatetime AS TIMESTAMP)) IN (1, 2, 3) AS s02,
  MONTH(CAST(sbtxdatetime AS TIMESTAMP)) IN (4, 5, 6) AS s03,
  MONTH(CAST(sbtxdatetime AS TIMESTAMP)) IN (7, 8, 9) AS s04,
  MONTH(CAST(sbtxdatetime AS TIMESTAMP)) IN (10, 11, 12) AS s05,
  FALSE AS s06,
  FALSE AS s07,
  MONTH(CAST(sbtxdatetime AS TIMESTAMP)) < 4 AS s08,
  MONTH(CAST(sbtxdatetime AS TIMESTAMP)) < 7 AS s09,
  MONTH(CAST(sbtxdatetime AS TIMESTAMP)) < 10 AS s10,
  TRUE AS s11,
  FALSE AS s12,
  MONTH(CAST(sbtxdatetime AS TIMESTAMP)) <= 3 AS s13,
  MONTH(CAST(sbtxdatetime AS TIMESTAMP)) <= 6 AS s14,
  MONTH(CAST(sbtxdatetime AS TIMESTAMP)) <= 9 AS s15,
  TRUE AS s16,
  TRUE AS s17,
  MONTH(CAST(sbtxdatetime AS TIMESTAMP)) > 3 AS s18,
  MONTH(CAST(sbtxdatetime AS TIMESTAMP)) > 6 AS s19,
  MONTH(CAST(sbtxdatetime AS TIMESTAMP)) > 9 AS s20,
  FALSE AS s21,
  TRUE AS s22,
  MONTH(CAST(sbtxdatetime AS TIMESTAMP)) >= 4 AS s23,
  MONTH(CAST(sbtxdatetime AS TIMESTAMP)) >= 7 AS s24,
  MONTH(CAST(sbtxdatetime AS TIMESTAMP)) >= 10 AS s25,
  FALSE AS s26,
  TRUE AS s27,
  NOT MONTH(CAST(sbtxdatetime AS TIMESTAMP)) IN (1, 2, 3) AS s28,
  NOT MONTH(CAST(sbtxdatetime AS TIMESTAMP)) IN (4, 5, 6) AS s29,
  NOT MONTH(CAST(sbtxdatetime AS TIMESTAMP)) IN (7, 8, 9) AS s30,
  NOT MONTH(CAST(sbtxdatetime AS TIMESTAMP)) IN (10, 11, 12) AS s31,
  TRUE AS s32,
  2024 AS s33,
  3 AS s34,
  8 AS s35,
  13 AS s36,
  12 AS s37,
  45 AS s38,
  59 AS s39,
  2020 AS s40,
  1 AS s41,
  1 AS s42,
  31 AS s43,
  0 AS s44,
  0 AS s45,
  0 AS s46,
  2023 AS s47,
  3 AS s48,
  7 AS s49,
  4 AS s50,
  6 AS s51,
  55 AS s52,
  0 AS s53,
  1999 AS s54,
  4 AS s55,
  12 AS s56,
  31 AS s57,
  23 AS s58,
  59 AS s59,
  58 AS s60,
  FALSE AS s61,
  FALSE AS s62,
  FALSE AS s63,
  TRUE AS s64,
  TRUE AS s65,
  TRUE AS s66,
  FALSE AS s67,
  FALSE AS s68,
  FALSE AS s69,
  TRUE AS s70,
  TRUE AS s71,
  TRUE AS s72,
  FALSE AS s73,
  FALSE AS s74,
  TRUE AS s75,
  TRUE AS s76,
  FALSE AS s77,
  TRUE AS s78,
  FALSE AS s79,
  TRUE AS s80,
  TRUE AS s81,
  FALSE AS s82,
  TRUE AS s83,
  FALSE AS s84,
  FALSE AS s85,
  TRUE AS s86,
  FALSE AS s87,
  FALSE AS s88,
  TRUE AS s89,
  TRUE AS s90,
  FALSE AS s91,
  TRUE AS s92,
  FALSE AS s93,
  FALSE AS s94,
  TRUE AS s95,
  TRUE AS s96,
  CAST('2025-02-28' AS DATE) AS s97
FROM _t1
