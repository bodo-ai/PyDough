ROOT(columns=[('tod', tod), ('pct_searches', pct_searches), ('avg_results', avg_results)], orderings=[(agg_4):asc_first])
 PROJECT(columns={'agg_4': agg_4, 'avg_results': ROUND(agg_0, 2:numeric), 'pct_searches': ROUND(100.0:numeric * agg_1 / RELSUM(args=[agg_1], partition=[], order=[]), 2:numeric), 'tod': agg_3})
  AGGREGATE(keys={'name': name}, aggregations={'agg_0': AVG(n_results), 'agg_1': COUNT(), 'agg_3': ANYTHING(name), 'agg_4': ANYTHING(start_hour)})
   JOIN(condition=t0.start_hour <= HOUR(t1.ts) & HOUR(t1.ts) < t0.end_hour, type=INNER, columns={'n_results': t1.n_results, 'name': t0.name, 'start_hour': t0.start_hour})
    SCAN(table=TIMES, columns={'end_hour': t_end_hour, 'name': t_name, 'start_hour': t_start_hour})
    SCAN(table=SEARCHES, columns={'n_results': search_num_results, 'ts': search_ts})
