ROOT(columns=[('years_since_release', years_since_release), ('cum_ir', cum_ir), ('pct_bought_change', pct_bought_change), ('pct_incident_change', pct_incident_change), ('bought', n_devices), ('incidents', n_incidents)], orderings=[(years_since_release):asc_first])
 PROJECT(columns={'cum_ir': ROUND(RELSUM(args=[n_incidents], partition=[], order=[(year):asc_last], cumulative=True) / RELSUM(args=[n_devices], partition=[], order=[(year):asc_last], cumulative=True), 2:numeric), 'n_devices': n_devices, 'n_incidents': n_incidents, 'pct_bought_change': ROUND(100.0:numeric * n_devices - PREV(args=[n_devices], partition=[], order=[(year):asc_last]) / PREV(args=[n_devices], partition=[], order=[(year):asc_last]), 2:numeric), 'pct_incident_change': ROUND(100.0:numeric * n_incidents - PREV(args=[n_incidents], partition=[], order=[(year):asc_last]) / PREV(args=[n_incidents], partition=[], order=[(year):asc_last]), 2:numeric), 'years_since_release': year - YEAR(release_date)})
  PROJECT(columns={'n_devices': DEFAULT_TO(sum_n_rows, 0:numeric), 'n_incidents': DEFAULT_TO(sum_expr_4, 0:numeric), 'release_date': release_date, 'year': year})
   FILTER(condition=YEAR(release_date) <= year, columns={'release_date': release_date, 'sum_expr_4': sum_expr_4, 'sum_n_rows': sum_n_rows, 'year': year})
    JOIN(condition=True:bool, type=INNER, cardinality=SINGULAR_ACCESS, columns={'release_date': t0.release_date, 'sum_expr_4': t1.sum_expr_4, 'sum_n_rows': t1.sum_n_rows, 'year': t1.year})
     AGGREGATE(keys={}, aggregations={'release_date': ANYTHING(pr_release)})
      FILTER(condition=pr_name == 'GoldCopper-Star':string, columns={'pr_release': pr_release})
       SCAN(table=main.PRODUCTS, columns={'pr_name': pr_name, 'pr_release': pr_release})
     AGGREGATE(keys={'year': year}, aggregations={'sum_expr_4': SUM(expr_4), 'sum_n_rows': SUM(n_rows)})
      JOIN(condition=t0.ca_dt == t1.ca_dt, type=LEFT, cardinality=SINGULAR_ACCESS, columns={'expr_4': t0.n_rows, 'n_rows': t1.n_rows, 'year': t0.year})
       JOIN(condition=t0.ca_dt == t1.ca_dt, type=LEFT, cardinality=SINGULAR_ACCESS, columns={'ca_dt': t0.ca_dt, 'n_rows': t1.n_rows, 'year': t0.year})
        PROJECT(columns={'ca_dt': ca_dt, 'year': YEAR(ca_dt)})
         SCAN(table=main.CALENDAR, columns={'ca_dt': ca_dt})
        AGGREGATE(keys={'ca_dt': ca_dt}, aggregations={'n_rows': COUNT()})
         JOIN(condition=t0.de_product_id == t1.pr_id, type=INNER, cardinality=SINGULAR_FILTER, columns={'ca_dt': t0.ca_dt})
          JOIN(condition=t0.in_device_id == t1.de_id, type=INNER, cardinality=SINGULAR_ACCESS, columns={'ca_dt': t0.ca_dt, 'de_product_id': t1.de_product_id})
           JOIN(condition=t0.ca_dt == DATETIME(t1.in_error_report_ts, 'start of day':string), type=INNER, cardinality=PLURAL_FILTER, columns={'ca_dt': t0.ca_dt, 'in_device_id': t1.in_device_id})
            SCAN(table=main.CALENDAR, columns={'ca_dt': ca_dt})
            SCAN(table=main.INCIDENTS, columns={'in_device_id': in_device_id, 'in_error_report_ts': in_error_report_ts})
           SCAN(table=main.DEVICES, columns={'de_id': de_id, 'de_product_id': de_product_id})
          FILTER(condition=pr_name == 'GoldCopper-Star':string, columns={'pr_id': pr_id})
           SCAN(table=main.PRODUCTS, columns={'pr_id': pr_id, 'pr_name': pr_name})
       AGGREGATE(keys={'ca_dt': ca_dt}, aggregations={'n_rows': COUNT()})
        JOIN(condition=t0.de_product_id == t1.pr_id, type=INNER, cardinality=SINGULAR_FILTER, columns={'ca_dt': t0.ca_dt})
         JOIN(condition=t0.ca_dt == DATETIME(t1.de_purchase_ts, 'start of day':string), type=INNER, cardinality=PLURAL_FILTER, columns={'ca_dt': t0.ca_dt, 'de_product_id': t1.de_product_id})
          SCAN(table=main.CALENDAR, columns={'ca_dt': ca_dt})
          SCAN(table=main.DEVICES, columns={'de_product_id': de_product_id, 'de_purchase_ts': de_purchase_ts})
         FILTER(condition=pr_name == 'GoldCopper-Star':string, columns={'pr_id': pr_id})
          SCAN(table=main.PRODUCTS, columns={'pr_id': pr_id, 'pr_name': pr_name})
