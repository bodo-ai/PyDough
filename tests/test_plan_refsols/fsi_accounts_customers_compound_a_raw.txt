ROOT(columns=[('n', n_rows)], orderings=[])
 AGGREGATE(keys={}, aggregations={'n_rows': COUNT()})
  JOIN(condition=t0.customerid == t1.customerid, type=INNER, cardinality=SINGULAR_FILTER, reverse_cardinality=PLURAL_FILTER, columns={})
   FILTER(condition=(UNMASK::(PTY_UNPROTECT_ACCOUNT([currency])) != 'GBP':string) & (balance < 20000:numeric), columns={'customerid': customerid})
    SCAN(table=bodo.fsi.accounts, columns={'balance': balance, 'currency': currency, 'customerid': customerid})
   FILTER(condition=UNMASK::(PTY_UNPROTECT([state], 'deAddress')) == 'California':string, columns={'customerid': customerid})
    SCAN(table=bodo.fsi.protected_customers, columns={'customerid': customerid, 'state': state})
