ROOT(columns=[('region', user_region), ('event_type', ev_typ), ('n_searches', ndistinct_search_id)], orderings=[])
 FILTER(condition=RANKING(args=[], partition=[user_region], order=[(ndistinct_search_id):desc_first], allow_ties=False) == 1:numeric, columns={'ev_typ': ev_typ, 'ndistinct_search_id': ndistinct_search_id, 'user_region': user_region})
  AGGREGATE(keys={'ev_typ': ev_typ, 'user_region': user_region}, aggregations={'ndistinct_search_id': NDISTINCT(search_id)})
   JOIN(condition=t0.search_user_id == t1.user_id, type=INNER, cardinality=SINGULAR_ACCESS, columns={'ev_typ': t0.ev_typ, 'search_id': t0.search_id, 'user_region': t1.user_region})
    JOIN(condition=CONTAINS(LOWER(t1.search_string), LOWER(t0.ev_name)), type=INNER, cardinality=PLURAL_FILTER, columns={'ev_typ': t0.ev_typ, 'search_id': t1.search_id, 'search_user_id': t1.search_user_id})
     SCAN(table=EVENTS, columns={'ev_name': ev_name, 'ev_typ': ev_typ})
     SCAN(table=SEARCHES, columns={'search_id': search_id, 'search_string': search_string, 'search_user_id': search_user_id})
    SCAN(table=USERS, columns={'user_id': user_id, 'user_region': user_region})
