SELECT
  COUNT(*) AS num_transactions,
  CASE
    WHEN COUNT(*) <> 0
    THEN NVL(SUM(WALLET_TRANSACTIONS_DAILY.amount), 0)
    ELSE NULL
  END AS total_amount
FROM MAIN.WALLET_TRANSACTIONS_DAILY WALLET_TRANSACTIONS_DAILY
JOIN MAIN.USERS USERS
  ON USERS.country = 'US' AND USERS.uid = WALLET_TRANSACTIONS_DAILY.sender_id
WHERE
  DATEDIFF(CURRENT_TIMESTAMP, CAST(WALLET_TRANSACTIONS_DAILY.created_at AS DATETIME), DAY) <= 7
