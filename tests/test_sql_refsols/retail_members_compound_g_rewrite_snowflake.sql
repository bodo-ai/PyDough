SELECT
  COUNT(*) AS n
FROM bodo.retail.protected_loyalty_members
WHERE
  DAY(CAST(PTY_UNPROTECT(date_of_birth, 'deDOB') AS TIMESTAMP)) <= 13
  AND MONTH(CAST(PTY_UNPROTECT(date_of_birth, 'deDOB') AS TIMESTAMP)) IN (1, 2, 5, 10, 12)
  AND NOT date_of_birth IN ('0897-01-11', '0681-01-31', '2337-11-25', '0765-06-07', '3270-09-07', '3114-01-23', '0946-07-28', '0671-06-23', '1030-02-26', '2892-07-01', '1787-09-06', '2191-11-24', '0912-05-28', '1828-09-20', '1318-12-03', '0660-08-20', '1546-05-12', '2064-12-18', '1664-12-03', '0627-05-21', '1348-11-22', '3202-05-20', '0959-04-01', '1397-05-24', '3184-08-05', '2207-02-22', '2388-11-19', '2563-07-20', '3159-09-21', '2692-10-23', '1365-12-07', '1712-02-18', '0846-08-04', '3332-01-06', '2501-07-04', '3297-10-03', '2235-01-19', '2006-03-03', '2544-09-01', '1543-07-16')
  AND YEAR(CAST(PTY_UNPROTECT(date_of_birth, 'deDOB') AS TIMESTAMP)) IN (1960, 1970, 1980, 1990, 2000)
