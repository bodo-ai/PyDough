ROOT(columns=[('coverage_type', coverage_type), ('first_name', max_anythingunmaskfirstname), ('last_name', max_anythingunmasklastname), ('date_of_birth', max_anythingunmaskdateofbirth)], orderings=[(coverage_type):asc_first])
 FILTER(condition=sum_nrows > 0:numeric, columns={'coverage_type': coverage_type, 'max_anythingunmaskdateofbirth': max_anythingunmaskdateofbirth, 'max_anythingunmaskfirstname': max_anythingunmaskfirstname, 'max_anythingunmasklastname': max_anythingunmasklastname})
  AGGREGATE(keys={'coverage_type': coverage_type}, aggregations={'max_anythingunmaskdateofbirth': MAX(anything_unmaskdateofbirth), 'max_anythingunmaskfirstname': MAX(anything_unmaskfirstname), 'max_anythingunmasklastname': MAX(anything_unmasklastname), 'sum_nrows': SUM(n_rows)})
   JOIN(condition=t0.insurance_plan_id == t1.insurance_plan_id, type=LEFT, cardinality=SINGULAR_FILTER, reverse_cardinality=SINGULAR_ACCESS, columns={'anything_unmaskdateofbirth': t1.anything_unmaskdateofbirth, 'anything_unmaskfirstname': t1.anything_unmaskfirstname, 'anything_unmasklastname': t1.anything_unmasklastname, 'coverage_type': t0.coverage_type, 'n_rows': t1.n_rows})
    SCAN(table=bodo.health.insurance_plans, columns={'coverage_type': coverage_type, 'insurance_plan_id': insurance_plan_id})
    AGGREGATE(keys={'insurance_plan_id': insurance_plan_id}, aggregations={'anything_unmaskdateofbirth': ANYTHING(UNMASK::(PTY_UNPROTECT([date_of_birth], 'deDOB'))), 'anything_unmaskfirstname': ANYTHING(UNMASK::(PTY_UNPROTECT_NAME([first_name]))), 'anything_unmasklastname': ANYTHING(UNMASK::(PTY_UNPROTECT([last_name], 'deName'))), 'n_rows': COUNT()})
     FILTER(condition=RANKING(args=[], partition=[coverage_type], order=[(UNMASK::(PTY_UNPROTECT([date_of_birth], 'deDOB'))):asc_last, (UNMASK::(PTY_UNPROTECT_ACCOUNT([patient_id]))):asc_last], allow_ties=False) == 1:numeric, columns={'date_of_birth': date_of_birth, 'first_name': first_name, 'insurance_plan_id': insurance_plan_id, 'last_name': last_name})
      JOIN(condition=t0.insurance_plan_id == t1.insurance_plan_id, type=INNER, cardinality=PLURAL_ACCESS, reverse_cardinality=SINGULAR_ACCESS, columns={'coverage_type': t0.coverage_type, 'date_of_birth': t1.date_of_birth, 'first_name': t1.first_name, 'insurance_plan_id': t0.insurance_plan_id, 'last_name': t1.last_name, 'patient_id': t1.patient_id})
       SCAN(table=bodo.health.insurance_plans, columns={'coverage_type': coverage_type, 'insurance_plan_id': insurance_plan_id})
       SCAN(table=bodo.health.protected_patients, columns={'date_of_birth': date_of_birth, 'first_name': first_name, 'insurance_plan_id': insurance_plan_id, 'last_name': last_name, 'patient_id': patient_id})
