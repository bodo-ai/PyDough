ROOT(columns=[('years_since_release', years_since_release), ('cum_ir', cum_ir), ('pct_bought_change', pct_bought_change), ('pct_incident_change', pct_incident_change), ('bought', bought), ('incidents', incidents)], orderings=[(years_since_release):asc_first])
 PROJECT(columns={'bought': n_devices, 'cum_ir': ROUND(RELSUM(args=[n_incidents], partition=[], order=[(year):asc_last], cumulative=True) / RELSUM(args=[n_devices], partition=[], order=[(year):asc_last], cumulative=True), 2:numeric), 'incidents': n_incidents, 'pct_bought_change': ROUND(100.0:numeric * n_devices - PREV(args=[n_devices], partition=[], order=[(year):asc_last]) / PREV(args=[n_devices], partition=[], order=[(year):asc_last]), 2:numeric), 'pct_incident_change': ROUND(100.0:numeric * n_incidents - PREV(args=[n_incidents], partition=[], order=[(year):asc_last]) / PREV(args=[n_incidents], partition=[], order=[(year):asc_last]), 2:numeric), 'years_since_release': year - YEAR(release_date)})
  PROJECT(columns={'n_devices': DEFAULT_TO(agg_8, 0:numeric), 'n_incidents': DEFAULT_TO(agg_5, 0:numeric), 'release_date': release_date, 'year': year})
   FILTER(condition=YEAR(release_date) <= year, columns={'agg_5': agg_5, 'agg_8': agg_8, 'release_date': release_date, 'year': year})
    JOIN(conditions=[True:bool], types=['inner'], columns={'agg_5': t1.agg_5, 'agg_8': t1.agg_8, 'release_date': t0.release_date, 'year': t1.year})
     AGGREGATE(keys={}, aggregations={'release_date': ANYTHING(release_date)})
      FILTER(condition=name == 'GoldCopper-Star':string, columns={'release_date': release_date})
       SCAN(table=main.PRODUCTS, columns={'name': pr_name, 'release_date': pr_release})
     AGGREGATE(keys={'year': year}, aggregations={'agg_5': SUM(expr_4), 'agg_8': SUM(expr_7)})
      PROJECT(columns={'expr_4': expr_4, 'expr_7': agg_6, 'year': year})
       JOIN(conditions=[t0.calendar_day == t1.calendar_day], types=['left'], columns={'agg_6': t1.agg_6, 'expr_4': t0.expr_4, 'year': t0.year})
        PROJECT(columns={'calendar_day': calendar_day, 'expr_4': agg_3, 'year': year})
         JOIN(conditions=[t0.calendar_day == t1.calendar_day], types=['left'], columns={'agg_3': t1.agg_3, 'calendar_day': t0.calendar_day, 'year': t0.year})
          PROJECT(columns={'calendar_day': calendar_day, 'year': YEAR(calendar_day)})
           SCAN(table=main.CALENDAR, columns={'calendar_day': ca_dt})
          AGGREGATE(keys={'calendar_day': calendar_day}, aggregations={'agg_3': COUNT()})
           JOIN(conditions=[t0.product_id == t1._id], types=['inner'], columns={'calendar_day': t0.calendar_day})
            JOIN(conditions=[t0.device_id == t1._id], types=['inner'], columns={'calendar_day': t0.calendar_day, 'product_id': t1.product_id})
             JOIN(conditions=[t0.calendar_day == DATETIME(t1.reported_timestamp, 'start of day':string)], types=['inner'], columns={'calendar_day': t0.calendar_day, 'device_id': t1.device_id})
              SCAN(table=main.CALENDAR, columns={'calendar_day': ca_dt})
              SCAN(table=main.INCIDENTS, columns={'device_id': in_device_id, 'reported_timestamp': in_error_report_ts})
             SCAN(table=main.DEVICES, columns={'_id': de_id, 'product_id': de_product_id})
            FILTER(condition=name == 'GoldCopper-Star':string, columns={'_id': _id})
             SCAN(table=main.PRODUCTS, columns={'_id': pr_id, 'name': pr_name})
        AGGREGATE(keys={'calendar_day': calendar_day}, aggregations={'agg_6': COUNT()})
         JOIN(conditions=[t0.product_id == t1._id], types=['inner'], columns={'calendar_day': t0.calendar_day})
          JOIN(conditions=[t0.calendar_day == DATETIME(t1.purchase_timestamp, 'start of day':string)], types=['inner'], columns={'calendar_day': t0.calendar_day, 'product_id': t1.product_id})
           SCAN(table=main.CALENDAR, columns={'calendar_day': ca_dt})
           SCAN(table=main.DEVICES, columns={'product_id': de_product_id, 'purchase_timestamp': de_purchase_ts})
          FILTER(condition=name == 'GoldCopper-Star':string, columns={'_id': _id})
           SCAN(table=main.PRODUCTS, columns={'_id': pr_id, 'name': pr_name})
