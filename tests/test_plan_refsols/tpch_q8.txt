ROOT(columns=[('O_YEAR', O_YEAR), ('MKT_SHARE', DEFAULT_TO(agg_0, 0:numeric) / DEFAULT_TO(agg_1, 0:numeric))], orderings=[])
 AGGREGATE(keys={'O_YEAR': O_YEAR}, aggregations={'agg_0': SUM(brazil_volume), 'agg_1': SUM(volume)})
  PROJECT(columns={'O_YEAR': YEAR(order_date), 'brazil_volume': IFF(name_12 == 'BRAZIL':string, extended_price * 1:numeric - discount, 0:numeric), 'volume': extended_price * 1:numeric - discount})
   JOIN(conditions=[t0.supplier_key == t1.key], types=['inner'], columns={'discount': t0.discount, 'extended_price': t0.extended_price, 'name_12': t1.name_12, 'order_date': t0.order_date})
    JOIN(conditions=[t0.order_key == t1.key], types=['inner'], columns={'discount': t0.discount, 'extended_price': t0.extended_price, 'order_date': t1.order_date, 'supplier_key': t0.supplier_key})
     JOIN(conditions=[t0.part_key == t1.key], types=['inner'], columns={'discount': t0.discount, 'extended_price': t0.extended_price, 'order_key': t0.order_key, 'supplier_key': t0.supplier_key})
      SCAN(table=tpch.LINEITEM, columns={'discount': l_discount, 'extended_price': l_extendedprice, 'order_key': l_orderkey, 'part_key': l_partkey, 'supplier_key': l_suppkey})
      FILTER(condition=part_type == 'ECONOMY ANODIZED STEEL':string, columns={'key': key})
       SCAN(table=tpch.PART, columns={'key': p_partkey, 'part_type': p_type})
     JOIN(conditions=[t0.customer_key == t1.key], types=['inner'], columns={'key': t1.key, 'order_date': t0.order_date})
      FILTER(condition=ISIN(YEAR(order_date), [1995, 1996]:array[unknown]), columns={'customer_key': customer_key, 'order_date': order_date})
       SCAN(table=tpch.ORDERS, columns={'customer_key': o_custkey, 'order_date': o_orderdate})
      JOIN(conditions=[t0.region_key == t1.key], types=['inner'], columns={'key': t1.key})
       JOIN(conditions=[t0.nation_key == t1.key], types=['inner'], columns={'region_key': t1.region_key})
        SCAN(table=tpch.CUSTOMER, columns={'nation_key': c_nationkey})
        SCAN(table=tpch.NATION, columns={'key': n_nationkey, 'region_key': n_regionkey})
       FILTER(condition=name == 'AMERICA':string, columns={'key': key})
        SCAN(table=tpch.REGION, columns={'key': r_regionkey, 'name': r_name})
    JOIN(conditions=[t0.nation_key == t1.key], types=['inner'], columns={'key': t0.key, 'name_12': t1.name})
     SCAN(table=tpch.SUPPLIER, columns={'key': s_suppkey, 'nation_key': s_nationkey})
     SCAN(table=tpch.NATION, columns={'key': n_nationkey, 'name': n_name})
