WITH _t AS (
  SELECT
    sbtxdatetime,
    ROW_NUMBER() OVER (ORDER BY sbtxdatetime) AS _w,
    ROW_NUMBER() OVER (ORDER BY sbtxdatetime DESC) AS _w_2
  FROM main.sbtransaction
  WHERE
    CAST(STRFTIME('%Y', sbtxdatetime) AS INTEGER) = 2023
)
SELECT
  sbtxdatetime AS date_time,
  DATE(
    sbtxdatetime,
    '-' || CAST((
      CAST(STRFTIME('%w', DATETIME(sbtxdatetime)) AS INTEGER) + 6
    ) % 7 AS TEXT) || ' days',
    'start of day',
    '-56 day'
  ) AS s00,
  FALSE AS s01,
  CAST(STRFTIME('%m', sbtxdatetime) AS INTEGER) IN (1, 2, 3) AS s02,
  CAST(STRFTIME('%m', sbtxdatetime) AS INTEGER) IN (4, 5, 6) AS s03,
  CAST(STRFTIME('%m', sbtxdatetime) AS INTEGER) IN (7, 8, 9) AS s04,
  CAST(STRFTIME('%m', sbtxdatetime) AS INTEGER) IN (10, 11, 12) AS s05,
  FALSE AS s06,
  FALSE AS s07,
  CAST(STRFTIME('%m', sbtxdatetime) AS INTEGER) < 4 AS s08,
  CAST(STRFTIME('%m', sbtxdatetime) AS INTEGER) < 7 AS s09,
  CAST(STRFTIME('%m', sbtxdatetime) AS INTEGER) < 10 AS s10,
  TRUE AS s11,
  FALSE AS s12,
  CAST(STRFTIME('%m', sbtxdatetime) AS INTEGER) <= 3 AS s13,
  CAST(STRFTIME('%m', sbtxdatetime) AS INTEGER) <= 6 AS s14,
  CAST(STRFTIME('%m', sbtxdatetime) AS INTEGER) <= 9 AS s15,
  TRUE AS s16,
  TRUE AS s17,
  CAST(STRFTIME('%m', sbtxdatetime) AS INTEGER) > 3 AS s18,
  CAST(STRFTIME('%m', sbtxdatetime) AS INTEGER) > 6 AS s19,
  CAST(STRFTIME('%m', sbtxdatetime) AS INTEGER) > 9 AS s20,
  FALSE AS s21,
  TRUE AS s22,
  CAST(STRFTIME('%m', sbtxdatetime) AS INTEGER) >= 4 AS s23,
  CAST(STRFTIME('%m', sbtxdatetime) AS INTEGER) >= 7 AS s24,
  CAST(STRFTIME('%m', sbtxdatetime) AS INTEGER) >= 10 AS s25,
  FALSE AS s26,
  TRUE AS s27,
  NOT CAST(STRFTIME('%m', sbtxdatetime) AS INTEGER) IN (1, 2, 3) AS s28,
  NOT CAST(STRFTIME('%m', sbtxdatetime) AS INTEGER) IN (4, 5, 6) AS s29,
  NOT CAST(STRFTIME('%m', sbtxdatetime) AS INTEGER) IN (7, 8, 9) AS s30,
  NOT CAST(STRFTIME('%m', sbtxdatetime) AS INTEGER) IN (10, 11, 12) AS s31,
  TRUE AS s32,
  2024 AS s33,
  3 AS s34,
  8 AS s35,
  13 AS s36,
  12 AS s37,
  45 AS s38,
  59 AS s39,
  2020 AS s40,
  1 AS s41,
  1 AS s42,
  31 AS s43,
  0 AS s44,
  0 AS s45,
  0 AS s46,
  2023 AS s47,
  3 AS s48,
  7 AS s49,
  4 AS s50,
  6 AS s51,
  55 AS s52,
  0 AS s53,
  1999 AS s54,
  4 AS s55,
  12 AS s56,
  31 AS s57,
  23 AS s58,
  59 AS s59,
  58 AS s60,
  FALSE AS s61,
  FALSE AS s62,
  FALSE AS s63,
  TRUE AS s64,
  TRUE AS s65,
  TRUE AS s66,
  FALSE AS s67,
  FALSE AS s68,
  FALSE AS s69,
  TRUE AS s70,
  TRUE AS s71,
  TRUE AS s72,
  FALSE AS s73,
  FALSE AS s74,
  TRUE AS s75,
  TRUE AS s76,
  FALSE AS s77,
  TRUE AS s78,
  FALSE AS s79,
  TRUE AS s80,
  TRUE AS s81,
  FALSE AS s82,
  TRUE AS s83,
  FALSE AS s84,
  FALSE AS s85,
  TRUE AS s86,
  FALSE AS s87,
  FALSE AS s88,
  TRUE AS s89,
  TRUE AS s90,
  FALSE AS s91,
  TRUE AS s92,
  FALSE AS s93,
  FALSE AS s94,
  TRUE AS s95,
  TRUE AS s96,
  '2025-02-28' AS s97
FROM _t
WHERE
  _w = 1 OR _w_2 = 1
