SELECT
  COALESCE(COUNT_IF(status = 'success'), 0) / COUNT(*) AS _expr0
FROM MAIN.WALLET_TRANSACTIONS_DAILY
WHERE
  DATEDIFF(MONTH, CAST(created_at AS DATETIME), CURRENT_TIMESTAMP()) = 1
